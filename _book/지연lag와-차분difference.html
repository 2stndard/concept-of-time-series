<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.2 지연(Lag)와 차분(Difference) | t.utf8</title>
  <meta name="description" content="<center>
교육통계를 활용한 데이터 분석 방법
</center>" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5.2 지연(Lag)와 차분(Difference) | t.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.2 지연(Lag)와 차분(Difference) | t.utf8" />
  
  
  

<meta name="author" content="이기준" />


<meta name="date" content="2021-02-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="정상성stationary-비정상성non-stationary.html"/>
<link rel="next" href="acf와-pacf.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">교육통계를 활용한 데이터 분석 방법</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 시계열 데이터</a>
<ul>
<li class="chapter" data-level="1.1" data-path="정의.html"><a href="정의.html"><i class="fa fa-check"></i><b>1.1</b> 정의</a></li>
<li class="chapter" data-level="1.2" data-path="특성.html"><a href="특성.html"><i class="fa fa-check"></i><b>1.2</b> 특성</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="특성.html"><a href="특성.html#자기-상관관계"><i class="fa fa-check"></i><b>1.2.1</b> 자기 상관관계</a></li>
<li class="chapter" data-level="1.2.2" data-path="특성.html"><a href="특성.html#추세-경향성trend"><i class="fa fa-check"></i><b>1.2.2</b> 추세 경향성(Trend)</a></li>
<li class="chapter" data-level="1.2.3" data-path="특성.html"><a href="특성.html#계절성seasonality-순환성cyclic"><i class="fa fa-check"></i><b>1.2.3</b> 계절성(Seasonality), 순환성(Cyclic)</a></li>
<li class="chapter" data-level="1.2.4" data-path="특성.html"><a href="특성.html#불확실성uncertainty"><i class="fa fa-check"></i><b>1.2.4</b> 불확실성(Uncertainty)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="시계열-데이터-타입-및-import.html"><a href="시계열-데이터-타입-및-import.html"><i class="fa fa-check"></i><b>2</b> 시계열 데이터 타입 및 Import</a>
<ul>
<li class="chapter" data-level="2.1" data-path="날짜시간-객체-타입.html"><a href="날짜시간-객체-타입.html"><i class="fa fa-check"></i><b>2.1</b> 날짜/시간 객체 타입</a></li>
<li class="chapter" data-level="2.2" data-path="시계열-패키지-및-데이터-타입.html"><a href="시계열-패키지-및-데이터-타입.html"><i class="fa fa-check"></i><b>2.2</b> 시계열 패키지 및 데이터 타입</a></li>
<li class="chapter" data-level="2.3" data-path="시계열-데이터-import의-방법.html"><a href="시계열-데이터-import의-방법.html"><i class="fa fa-check"></i><b>2.3</b> 시계열 데이터 Import의 방법</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="시계열-visualization.html"><a href="시계열-visualization.html"><i class="fa fa-check"></i><b>3</b> 시계열 Visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>3.1</b> ggplot2</a></li>
<li class="chapter" data-level="3.2" data-path="xts.html"><a href="xts.html"><i class="fa fa-check"></i><b>3.2</b> XTS</a></li>
<li class="chapter" data-level="3.3" data-path="forecast.html"><a href="forecast.html"><i class="fa fa-check"></i><b>3.3</b> forecast</a></li>
<li class="chapter" data-level="3.4" data-path="timetk.html"><a href="timetk.html"><i class="fa fa-check"></i><b>3.4</b> timetk</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="시계열-데이터-handling.html"><a href="시계열-데이터-handling.html"><i class="fa fa-check"></i><b>4</b> 시계열 데이터 Handling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html"><i class="fa fa-check"></i><b>4.1</b> 시계열 데이터 정보 다루기</a></li>
<li class="chapter" data-level="4.2" data-path="시계열-데이터-연산.html"><a href="시계열-데이터-연산.html"><i class="fa fa-check"></i><b>4.2</b> 시계열 데이터 연산</a></li>
<li class="chapter" data-level="4.3" data-path="시계열-데이터-반올림.html"><a href="시계열-데이터-반올림.html"><i class="fa fa-check"></i><b>4.3</b> 시계열 데이터 반올림</a></li>
<li class="chapter" data-level="4.4" data-path="시계열-데이터-grouping.html"><a href="시계열-데이터-grouping.html"><i class="fa fa-check"></i><b>4.4</b> 시계열 데이터 Grouping</a></li>
<li class="chapter" data-level="4.5" data-path="시계열-데이터-ohlc.html"><a href="시계열-데이터-ohlc.html"><i class="fa fa-check"></i><b>4.5</b> 시계열 데이터 OHLC</a></li>
<li class="chapter" data-level="4.6" data-path="시계열-데이터-누적값.html"><a href="시계열-데이터-누적값.html"><i class="fa fa-check"></i><b>4.6</b> 시계열 데이터 누적값</a></li>
<li class="chapter" data-level="4.7" data-path="시계열-데이터-rolling.html"><a href="시계열-데이터-rolling.html"><i class="fa fa-check"></i><b>4.7</b> 시계열 데이터 Rolling</a></li>
<li class="chapter" data-level="4.8" data-path="시계열-데이터-filtering.html"><a href="시계열-데이터-filtering.html"><i class="fa fa-check"></i><b>4.8</b> 시계열 데이터 Filtering</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="시계열-forecasting-part-i-기초컨셉.html"><a href="시계열-forecasting-part-i-기초컨셉.html"><i class="fa fa-check"></i><b>5</b> 시계열 forecasting Part I - 기초컨셉</a>
<ul>
<li class="chapter" data-level="5.1" data-path="정상성stationary-비정상성non-stationary.html"><a href="정상성stationary-비정상성non-stationary.html"><i class="fa fa-check"></i><b>5.1</b> 정상성(Stationary), 비정상성(Non-Stationary)</a></li>
<li class="chapter" data-level="5.2" data-path="지연lag와-차분difference.html"><a href="지연lag와-차분difference.html"><i class="fa fa-check"></i><b>5.2</b> 지연(Lag)와 차분(Difference)</a></li>
<li class="chapter" data-level="5.3" data-path="acf와-pacf.html"><a href="acf와-pacf.html"><i class="fa fa-check"></i><b>5.3</b> ACF와 PACF</a></li>
<li class="chapter" data-level="5.4" data-path="적합값fitted-value-와-잔차residuals.html"><a href="적합값fitted-value-와-잔차residuals.html"><i class="fa fa-check"></i><b>5.4</b> 적합값(fitted value) 와 잔차(residuals)</a></li>
<li class="chapter" data-level="5.5" data-path="백색-잡음white-noise.html"><a href="백색-잡음white-noise.html"><i class="fa fa-check"></i><b>5.5</b> 백색 잡음(White Noise)</a></li>
<li class="chapter" data-level="5.6" data-path="시계열-분해decomposition.html"><a href="시계열-분해decomposition.html"><i class="fa fa-check"></i><b>5.6</b> 시계열 분해(Decomposition)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="시계열-forecasting-part-ii-시계열-모델링-알고리즘.html"><a href="시계열-forecasting-part-ii-시계열-모델링-알고리즘.html"><i class="fa fa-check"></i><b>6</b> 시계열 forecasting Part II - 시계열 모델링 알고리즘</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simple-모델링-알고리즘.html"><a href="simple-모델링-알고리즘.html"><i class="fa fa-check"></i><b>6.1</b> Simple 모델링 알고리즘</a></li>
<li class="chapter" data-level="6.2" data-path="regression-모델.html"><a href="regression-모델.html"><i class="fa fa-check"></i><b>6.2</b> Regression 모델</a></li>
<li class="chapter" data-level="6.3" data-path="exponential-smoothing-모델.html"><a href="exponential-smoothing-모델.html"><i class="fa fa-check"></i><b>6.3</b> Exponential Smoothing 모델</a></li>
<li class="chapter" data-level="6.4" data-path="arima-모델.html"><a href="arima-모델.html"><i class="fa fa-check"></i><b>6.4</b> ARIMA 모델</a></li>
<li class="chapter" data-level="6.5" data-path="tbat-모델.html"><a href="tbat-모델.html"><i class="fa fa-check"></i><b>6.5</b> TBAT 모델</a></li>
<li class="chapter" data-level="6.6" data-path="neural-network-모델.html"><a href="neural-network-모델.html"><i class="fa fa-check"></i><b>6.6</b> Neural Network 모델</a></li>
<li class="chapter" data-level="6.7" data-path="bootstrapping과-begging-모델.html"><a href="bootstrapping과-begging-모델.html"><i class="fa fa-check"></i><b>6.7</b> Bootstrapping과 Begging 모델</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="시계열-forecasting-part-iii-성능-분석.html"><a href="시계열-forecasting-part-iii-성능-분석.html"><i class="fa fa-check"></i><b>7</b> 시계열 forecasting Part III - 성능 분석</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><center>
교육통계를 활용한 데이터 분석 방법
</center></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="지연lag와-차분difference" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> 지연(Lag)와 차분(Difference)</h2>
<p>앞서 설명한 바와 같이 시계열 데이터 분석은 비정상성 시계열 데이터를 정상화하는 과정의 패턴을 찾아내는 것이다. 비정상성 시계열을 정상성 시계열로 반드는 방법 중 가장 대표적인 것이 지연(Lag)와 차분(Difference)이다.</p>
<ul>
<li>지연(Lag)</li>
</ul>
<p>지연은 정해진 시간동안 데이터를 앞으로 혹은 뒤로 당기거나 밀어내어 생성되는 데이터를 말한다. 지연은 데이터의 자기상관성(Autocorelation)을 측정하기 위해 필수적으로 필요한 데이터이다. 지연 1의 데이터는 원본 데이터에 시간 period 1만큼 딜레이된 데이터가 생성된다. 예를 들어 매일 기록된 주기의 데이터는 다음날 데이터로 전날 데이터를 사용하는 형태이다. 지연을 구하는 함수는 lag()를 통해 쉽게 산출이 가능하다.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="지연lag와-차분difference.html#cb1-1" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="지연lag와-차분difference.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(지역규모 <span class="sc">==</span> <span class="st">&#39;계&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="지연lag와-차분difference.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lag1 =</span> <span class="fu">lag</span>(학생수계, <span class="dv">1</span>), </span>
<span id="cb1-4"><a href="지연lag와-차분difference.html#cb1-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">lag3 =</span> <span class="fu">lag</span>(학생수계, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="지연lag와-차분difference.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(연도, 학생수계, lag1, lag3) <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="지연lag와-차분difference.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    연도 학생수계    lag1    lag3
## 1  1999  8658358      NA      NA
## 2  2000  8535867 8658358      NA
## 3  2001  8414423 8535867      NA
## 4  2002  8361933 8414423 8658358
## 5  2003  8379775 8361933 8535867
## 6  2004  8371630 8379775 8414423
## 7  2005  8371421 8371630 8361933
## 8  2006  8354891 8371421 8379775
## 9  2007  8309932 8354891 8371630
## 10 2008  8187782 8309932 8371421</code></pre>
<p>timetk 패키지에서도 lag() 함수와 유사한 함수인 lag_vec() 함수를 제공한다.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="지연lag와-차분difference.html#cb3-1" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="지연lag와-차분difference.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(지역규모 <span class="sc">==</span> <span class="st">&#39;계&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="지연lag와-차분difference.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lag1 =</span> timetk<span class="sc">::</span><span class="fu">lag_vec</span>(학생수계, <span class="at">lag =</span> <span class="dv">1</span>), </span>
<span id="cb3-4"><a href="지연lag와-차분difference.html#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">lag3 =</span> timetk<span class="sc">::</span><span class="fu">lag_vec</span>(학생수계, <span class="at">lag =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="지연lag와-차분difference.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(연도, 학생수계, lag1, lag3) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="지연lag와-차분difference.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    연도 학생수계    lag1    lag3
## 1  1999  8658358      NA      NA
## 2  2000  8535867 8658358      NA
## 3  2001  8414423 8535867      NA
## 4  2002  8361933 8414423 8658358
## 5  2003  8379775 8361933 8535867
## 6  2004  8371630 8379775 8414423
## 7  2005  8371421 8371630 8361933
## 8  2006  8354891 8371421 8379775
## 9  2007  8309932 8354891 8371630
## 10 2008  8187782 8309932 8371421</code></pre>
<p>xts 클래스의 객체도 lag() 함수를 동일하게 적용할 수 있다.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="지연lag와-차분difference.html#cb5-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">lag</span>(students.total.xts<span class="sc">$</span>학생수계, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##            학생수계
## 1999-01-01       NA
## 2000-01-01  8658358
## 2001-01-01  8535867
## 2002-01-01  8414423
## 2003-01-01  8361933
## 2004-01-01  8379775
## 2005-01-01  8371630
## 2006-01-01  8371421
## 2007-01-01  8354891
## 2008-01-01  8309932</code></pre>
<ul>
<li>차분(Difference)</li>
</ul>
<p>차분은 연속된 관찰값들간의 차이를 말한다. 비정상성 시계열 데이터를 정상성으로 만드는데 일반적으로 사용되는 방법으로 전년대비 증감량, 전월대비 증감량과 같이 특정한 시간 간격의 데이터와의 차이값을 나타낸다. 차분은 diff() 함수를 사용하여 간단히 구할 수 있고 앞의 lag()함수로 산출된 lag 벡터와의 연산을 통해서도 구할 수 있다. diff() 함수를 사용할 때 주의해야 할 점은 diff() 함수 결과 벡터는 원 데이터 벡터에 비해 lag만큼 데이터가 적다는 것이다. diff() 함수는 lag 만큼 데이터를 shift 시켜서 shift된 자리에서부터 마지막 데이터까지 연산을 하기 때문에 데이터가 적다. 따라서 이를 원래 데이터와 붙이기 위해서는 lag로 shift된 만큼 적절한 값을 채워줘야한다. 반면 lag 함수는 lag 만큼 shift된 자리에 NA를 채워준다.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="지연lag와-차분difference.html#cb7-1" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="지연lag와-차분difference.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(지역규모 <span class="sc">==</span> <span class="st">&#39;계&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="지연lag와-차분difference.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lag1 =</span> <span class="fu">lag</span>(학생수계, <span class="dv">1</span>), </span>
<span id="cb7-4"><a href="지연lag와-차분difference.html#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">lag3 =</span> <span class="fu">lag</span>(학생수계, <span class="dv">3</span>), </span>
<span id="cb7-5"><a href="지연lag와-차분difference.html#cb7-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff1 =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(학생수계, <span class="at">lag =</span> <span class="dv">1</span>)), </span>
<span id="cb7-6"><a href="지연lag와-차분difference.html#cb7-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff3 =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">diff</span>(학생수계, <span class="at">lag =</span> <span class="dv">3</span>)), </span>
<span id="cb7-7"><a href="지연lag와-차분difference.html#cb7-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff1.cal =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(lag1), 학생수계<span class="sc">-</span>lag1, <span class="cn">NA</span>), </span>
<span id="cb7-8"><a href="지연lag와-차분difference.html#cb7-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff3.cal =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(lag3), 학생수계<span class="sc">-</span>lag3, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="지연lag와-차분difference.html#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(연도, 학생수계, lag1, diff1, diff1.cal, lag3, diff3, diff3.cal) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="지연lag와-차분difference.html#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    연도 학생수계    lag1   diff1 diff1.cal    lag3   diff3 diff3.cal
## 1  1999  8658358      NA      NA        NA      NA      NA        NA
## 2  2000  8535867 8658358 -122491   -122491      NA      NA        NA
## 3  2001  8414423 8535867 -121444   -121444      NA      NA        NA
## 4  2002  8361933 8414423  -52490    -52490 8658358 -296425   -296425
## 5  2003  8379775 8361933   17842     17842 8535867 -156092   -156092
## 6  2004  8371630 8379775   -8145     -8145 8414423  -42793    -42793
## 7  2005  8371421 8371630    -209      -209 8361933    9488      9488
## 8  2006  8354891 8371421  -16530    -16530 8379775  -24884    -24884
## 9  2007  8309932 8354891  -44959    -44959 8371630  -61698    -61698
## 10 2008  8187782 8309932 -122150   -122150 8371421 -183639   -183639</code></pre>
<p>timetk 패키지에서도 diff() 함수와 유사한 함수인 diff_vec() 함수를 제공한다. diff_vec 함수는 lag 크기만큼의 빈자리를 NA로 채워원본 데이터와 동일한 길이의 벡터를 반환한다.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="지연lag와-차분difference.html#cb9-1" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="지연lag와-차분difference.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(지역규모 <span class="sc">==</span> <span class="st">&#39;계&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="지연lag와-차분difference.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff1 =</span> timetk<span class="sc">::</span><span class="fu">diff_vec</span>(학생수계, <span class="at">lag =</span> <span class="dv">1</span>), </span>
<span id="cb9-4"><a href="지연lag와-차분difference.html#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff3 =</span> timetk<span class="sc">::</span><span class="fu">diff_vec</span>(학생수계, <span class="at">lag =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="지연lag와-차분difference.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(연도, 학생수계, diff1, diff3) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="지연lag와-차분difference.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    연도 학생수계   diff1   diff3
## 1  1999  8658358      NA      NA
## 2  2000  8535867 -122491      NA
## 3  2001  8414423 -121444      NA
## 4  2002  8361933  -52490 -296425
## 5  2003  8379775   17842 -156092
## 6  2004  8371630   -8145  -42793
## 7  2005  8371421    -209    9488
## 8  2006  8354891  -16530  -24884
## 9  2007  8309932  -44959  -61698
## 10 2008  8187782 -122150 -183639</code></pre>
<p>xts 클래스 객체도 diff() 함수를 동일하게 적용할 수있다.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="지연lag와-차분difference.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(students.total.xts<span class="sc">$</span>학생수계, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##            학생수계
## 1999-01-01       NA
## 2000-01-01  -122491
## 2001-01-01  -121444
## 2002-01-01   -52490
## 2003-01-01    17842
## 2004-01-01    -8145
## 2005-01-01     -209
## 2006-01-01   -16530
## 2007-01-01   -44959
## 2008-01-01  -122150</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="정상성stationary-비정상성non-stationary.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="acf와-pacf.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["t.pdf", "t.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
