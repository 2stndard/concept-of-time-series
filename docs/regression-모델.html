<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.2 Regression 모델 | t.utf8</title>
  <meta name="description" content="<center>
교육통계를 활용한 데이터 분석 방법
</center>" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="6.2 Regression 모델 | t.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 Regression 모델 | t.utf8" />
  
  
  

<meta name="author" content="이기준" />


<meta name="date" content="2021-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-모델링-알고리즘.html"/>
<link rel="next" href="exponential-smoothing-모델.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">교육통계를 활용한 데이터 분석 방법</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 시계열 데이터</a>
<ul>
<li class="chapter" data-level="1.1" data-path="정의.html"><a href="정의.html"><i class="fa fa-check"></i><b>1.1</b> 정의</a></li>
<li class="chapter" data-level="1.2" data-path="특성.html"><a href="특성.html"><i class="fa fa-check"></i><b>1.2</b> 특성</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="특성.html"><a href="특성.html#자기-상관관계"><i class="fa fa-check"></i><b>1.2.1</b> 자기 상관관계</a></li>
<li class="chapter" data-level="1.2.2" data-path="특성.html"><a href="특성.html#추세-경향성trend"><i class="fa fa-check"></i><b>1.2.2</b> 추세 경향성(Trend)</a></li>
<li class="chapter" data-level="1.2.3" data-path="특성.html"><a href="특성.html#계절성seasonality-순환성cyclic"><i class="fa fa-check"></i><b>1.2.3</b> 계절성(Seasonality), 순환성(Cyclic)</a></li>
<li class="chapter" data-level="1.2.4" data-path="특성.html"><a href="특성.html#불확실성uncertainty"><i class="fa fa-check"></i><b>1.2.4</b> 불확실성(Uncertainty)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="시계열-데이터-타입-및-import.html"><a href="시계열-데이터-타입-및-import.html"><i class="fa fa-check"></i><b>2</b> 시계열 데이터 타입 및 Import</a>
<ul>
<li class="chapter" data-level="2.1" data-path="날짜시간-객체-타입.html"><a href="날짜시간-객체-타입.html"><i class="fa fa-check"></i><b>2.1</b> 날짜/시간 객체 타입</a></li>
<li class="chapter" data-level="2.2" data-path="시계열-패키지-및-데이터-타입.html"><a href="시계열-패키지-및-데이터-타입.html"><i class="fa fa-check"></i><b>2.2</b> 시계열 패키지 및 데이터 타입</a></li>
<li class="chapter" data-level="2.3" data-path="시계열-데이터-import의-방법.html"><a href="시계열-데이터-import의-방법.html"><i class="fa fa-check"></i><b>2.3</b> 시계열 데이터 Import의 방법</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="시계열-visualization.html"><a href="시계열-visualization.html"><i class="fa fa-check"></i><b>3</b> 시계열 Visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>3.1</b> ggplot2</a></li>
<li class="chapter" data-level="3.2" data-path="xts.html"><a href="xts.html"><i class="fa fa-check"></i><b>3.2</b> XTS</a></li>
<li class="chapter" data-level="3.3" data-path="forecast.html"><a href="forecast.html"><i class="fa fa-check"></i><b>3.3</b> forecast</a></li>
<li class="chapter" data-level="3.4" data-path="timetk.html"><a href="timetk.html"><i class="fa fa-check"></i><b>3.4</b> timetk</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="시계열-데이터-handling.html"><a href="시계열-데이터-handling.html"><i class="fa fa-check"></i><b>4</b> 시계열 데이터 Handling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html"><i class="fa fa-check"></i><b>4.1</b> 시계열 데이터 정보 다루기</a></li>
<li class="chapter" data-level="4.2" data-path="시계열-데이터-연산.html"><a href="시계열-데이터-연산.html"><i class="fa fa-check"></i><b>4.2</b> 시계열 데이터 연산</a></li>
<li class="chapter" data-level="4.3" data-path="시계열-데이터-반올림.html"><a href="시계열-데이터-반올림.html"><i class="fa fa-check"></i><b>4.3</b> 시계열 데이터 반올림</a></li>
<li class="chapter" data-level="4.4" data-path="시계열-데이터-grouping.html"><a href="시계열-데이터-grouping.html"><i class="fa fa-check"></i><b>4.4</b> 시계열 데이터 Grouping</a></li>
<li class="chapter" data-level="4.5" data-path="시계열-데이터-ohlc.html"><a href="시계열-데이터-ohlc.html"><i class="fa fa-check"></i><b>4.5</b> 시계열 데이터 OHLC</a></li>
<li class="chapter" data-level="4.6" data-path="시계열-데이터-누적값.html"><a href="시계열-데이터-누적값.html"><i class="fa fa-check"></i><b>4.6</b> 시계열 데이터 누적값</a></li>
<li class="chapter" data-level="4.7" data-path="시계열-데이터-rolling.html"><a href="시계열-데이터-rolling.html"><i class="fa fa-check"></i><b>4.7</b> 시계열 데이터 Rolling</a></li>
<li class="chapter" data-level="4.8" data-path="시계열-데이터-filtering.html"><a href="시계열-데이터-filtering.html"><i class="fa fa-check"></i><b>4.8</b> 시계열 데이터 Filtering</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="시계열-forecasting-part-i-기초컨셉.html"><a href="시계열-forecasting-part-i-기초컨셉.html"><i class="fa fa-check"></i><b>5</b> 시계열 forecasting Part I - 기초컨셉</a>
<ul>
<li class="chapter" data-level="5.1" data-path="정상성stationary-비정상성non-stationary.html"><a href="정상성stationary-비정상성non-stationary.html"><i class="fa fa-check"></i><b>5.1</b> 정상성(Stationary), 비정상성(Non-Stationary)</a></li>
<li class="chapter" data-level="5.2" data-path="지연lag와-차분difference.html"><a href="지연lag와-차분difference.html"><i class="fa fa-check"></i><b>5.2</b> 지연(Lag)와 차분(Difference)</a></li>
<li class="chapter" data-level="5.3" data-path="acf와-pacf.html"><a href="acf와-pacf.html"><i class="fa fa-check"></i><b>5.3</b> ACF와 PACF</a></li>
<li class="chapter" data-level="5.4" data-path="적합값fitted-value-와-잔차residuals.html"><a href="적합값fitted-value-와-잔차residuals.html"><i class="fa fa-check"></i><b>5.4</b> 적합값(fitted value) 와 잔차(residuals)</a></li>
<li class="chapter" data-level="5.5" data-path="백색-잡음white-noise.html"><a href="백색-잡음white-noise.html"><i class="fa fa-check"></i><b>5.5</b> 백색 잡음(White Noise)</a></li>
<li class="chapter" data-level="5.6" data-path="시계열-분해decomposition.html"><a href="시계열-분해decomposition.html"><i class="fa fa-check"></i><b>5.6</b> 시계열 분해(Decomposition)</a></li>
<li class="chapter" data-level="5.7" data-path="정상성-테스트.html"><a href="정상성-테스트.html"><i class="fa fa-check"></i><b>5.7</b> 정상성 테스트</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="시계열-forecasting-part-ii-시계열-모델링-알고리즘.html"><a href="시계열-forecasting-part-ii-시계열-모델링-알고리즘.html"><i class="fa fa-check"></i><b>6</b> 시계열 forecasting Part II - 시계열 모델링 알고리즘</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simple-모델링-알고리즘.html"><a href="simple-모델링-알고리즘.html"><i class="fa fa-check"></i><b>6.1</b> Simple 모델링 알고리즘</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="simple-모델링-알고리즘.html"><a href="simple-모델링-알고리즘.html#평균-모델forecastmeanf"><i class="fa fa-check"></i><b>6.1.1</b> 평균 모델(forecast::meanf)</a></li>
<li class="chapter" data-level="6.1.2" data-path="simple-모델링-알고리즘.html"><a href="simple-모델링-알고리즘.html#단순naive-모델"><i class="fa fa-check"></i><b>6.1.2</b> 단순(Naive) 모델</a></li>
<li class="chapter" data-level="6.1.3" data-path="simple-모델링-알고리즘.html"><a href="simple-모델링-알고리즘.html#계절성-단순seasonal-naive-모델"><i class="fa fa-check"></i><b>6.1.3</b> 계절성 단순(Seasonal Naive) 모델</a></li>
<li class="chapter" data-level="6.1.4" data-path="simple-모델링-알고리즘.html"><a href="simple-모델링-알고리즘.html#random-work-모델"><i class="fa fa-check"></i><b>6.1.4</b> random work 모델</a></li>
<li class="chapter" data-level="6.1.5" data-path="simple-모델링-알고리즘.html"><a href="simple-모델링-알고리즘.html#simple-모델-비교"><i class="fa fa-check"></i><b>6.1.5</b> Simple 모델 비교</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regression-모델.html"><a href="regression-모델.html"><i class="fa fa-check"></i><b>6.2</b> Regression 모델</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="regression-모델.html"><a href="regression-모델.html#시계열-선형회귀timer-series-linear-regression-모델"><i class="fa fa-check"></i><b>6.2.1</b> 시계열 선형회귀(Timer Series Linear Regression) 모델</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="exponential-smoothing-모델.html"><a href="exponential-smoothing-모델.html"><i class="fa fa-check"></i><b>6.3</b> Exponential Smoothing 모델</a></li>
<li class="chapter" data-level="6.4" data-path="arima-모델.html"><a href="arima-모델.html"><i class="fa fa-check"></i><b>6.4</b> ARIMA 모델</a></li>
<li class="chapter" data-level="6.5" data-path="tbat-모델.html"><a href="tbat-모델.html"><i class="fa fa-check"></i><b>6.5</b> TBAT 모델</a></li>
<li class="chapter" data-level="6.6" data-path="neural-network-모델.html"><a href="neural-network-모델.html"><i class="fa fa-check"></i><b>6.6</b> Neural Network 모델</a></li>
<li class="chapter" data-level="6.7" data-path="bootstrapping과-begging-모델.html"><a href="bootstrapping과-begging-모델.html"><i class="fa fa-check"></i><b>6.7</b> Bootstrapping과 Begging 모델</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="시계열-forecasting-part-iii-성능-분석.html"><a href="시계열-forecasting-part-iii-성능-분석.html"><i class="fa fa-check"></i><b>7</b> 시계열 forecasting Part III - 성능 분석</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><center>
교육통계를 활용한 데이터 분석 방법
</center></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression-모델" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Regression 모델</h2>
<p>회귀 모델은 선형 회귀(Linear Regression), 비선형 회귀,(Non-linear Regression) 로지스틱 회귀(Logistic Regression) 등의 방법이 있다. 회귀 모델은 종속변수와 독립변수와의 관계를 가장 잘 나타내는 회귀방정식을 도출하여 미래 데이터에 대한 예측치를 생성하는 방법으로 아직도 머신러닝 알고리즘 중에 가장 많이 사용되는 알고리즘 중에 하나이다.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<p>본 문서에서는 R에서 회귀 알고리즘을 구현하는 방법을 다루지는 않고 시계열 데이터의 회귀 알고리즘을 적용하는 방법에 대해 설명하겠다. 시계열 데이터의 회귀 모델은 두가지로 구분할 수 있다. 첫번째는 두가지이상의 시계열 데이터(Multivariate) 간의 회귀 모델과 한가지 시계열 데이터(Univariate)의 시간에 따른 회귀모델이다. 사실 첫번째 모델의 경우는 일반적 회귀모델과 큰 차이는 없지만 사용하는 함수는 시계열 패키지에서 따로 제공된다. 두번째 모델의 경우는 시계열 데이터의 특성인 추세(trend)와 계절성(season), 반복성(cycle)을 회귀에 반영한다는 점에서 일반적 회귀와는 차이가 있다.</p>
<div id="시계열-선형회귀timer-series-linear-regression-모델" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> 시계열 선형회귀(Timer Series Linear Regression) 모델</h3>
<p>시계열 선형 회귀 모델은 데이터간의 관계를 가장 잘 나타내는 직선(Linear)을 산출하여 미래 데이터를 예측하는 방법이다. 선형 회귀 모델은 선형 방정식으로 표현되는데 직선의 기울기(Slope)와 Y 축 절편(Intercept)의 계수(Coefficient)가 산출된다. 시계열 데이터의 선형 회귀를 위해서 forecast 패키지에서 tslm()함수, timetk 패키지의 plot_time_series_regressino() 함수(stats::lm() 함수를 사용하여 선형회귀 결과를 ploting하는 함수), modeltime 패키지(timetk 패키지의 모델링 패키지)의 linear_reg() 함수 등을 사용할 수 있다.</p>
<ul>
<li>tslm 함수(forecast 패키지)</li>
</ul>
<p>forecast 패키지에서 제공하는 tslm() 함수는 시계열 선형회귀 모델을 위한 함수이다. tslm() 함수는 lm() 함수의 래퍼 함수(Wrapper)로 사용법은 비슷하고 시간축이 독립변수에 포함되지 않은 두개 혹은 두개 이상의 시계열 객체에 대한 선형회귀는 lm() 함수의 결과와 같다. 즉 시계열 데이터이지만 독립변수 시간이 포함되지 않는다면 시계열 데이터로써의 특성이 적용되지 않은 양 데이터간의 특성정보만으로 선형회귀 방정식이 얻어진다.</p>
<p>반면 시간을 독립변수로 하여 선형회귀 모형을 적용하기 위해서는 ‘trend,’ ‘season’ 키워드를 함수식의 독립변수에 적용해 줌으로써 시간에 대한 선형회귀 방정식을 얻을 수 있다. ‘trend’는 시계열적인 추세를 반영하여 선형회귀 모델을 만들고 ’season’은 시계열의 계절성을 반영하여 회귀모델을 만들게 되는데 두가지를 모두 고려할 때는’+’ 기호로 연결하여 사용할 수 있다. 이 과정에서 추가적인 독립변수를 추가할 수도 있는데 독립변수를 추가할 때도 ‘+’ 기호를 사용하여 회귀모델을 만들 수 있다.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="regression-모델.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 학생수 예측 모델을 추세를 반영하여 생성</span></span>
<span id="cb49-2"><a href="regression-모델.html#cb49-2" aria-hidden="true" tabindex="-1"></a>student.ts.lm <span class="ot">&lt;-</span> <span class="fu">tslm</span>(students.total.ts[,<span class="dv">3</span>] <span class="sc">~</span> trend, <span class="at">data =</span> students.total.ts)</span>
<span id="cb49-3"><a href="regression-모델.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(student.ts.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## tslm(formula = students.total.ts[, 3] ~ trend, data = students.total.ts)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -378680 -174765     -58  210909  243604 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4402542      91504   48.11  &lt; 2e-16 ***
## trend         -88325       6967  -12.68 5.12e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 207300 on 20 degrees of freedom
## Multiple R-squared:  0.8893, Adjusted R-squared:  0.8838 
## F-statistic: 160.7 on 1 and 20 DF,  p-value: 5.119e-11</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="regression-모델.html#cb51-1" aria-hidden="true" tabindex="-1"></a>student.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>()  <span class="co"># tslm 함수로 생성된 모델을 forecast()함수를 통해 예측값을 생성</span></span></code></pre></div>
<pre><code>##      Point Forecast   Lo 80   Hi 80   Lo 95   Hi 95
## 2021        2371064 2070723 2671405 1898355 2843772
## 2022        2282739 1979011 2586467 1804699 2760779
## 2023        2194414 1887058 2501769 1710664 2678163
## 2024        2106089 1794874 2417304 1616265 2595912
## 2025        2017763 1702466 2333061 1521514 2514013
## 2026        1929438 1609843 2249033 1426426 2432451
## 2027        1841113 1517015 2165212 1331013 2351214
## 2028        1752788 1423989 2081588 1235288 2270288
## 2029        1664463 1330773 1998153 1139266 2189660
## 2030        1576138 1237376 1914899 1042959 2109317</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="regression-모델.html#cb53-1" aria-hidden="true" tabindex="-1"></a>student.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>() <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="t_files/figure-html/tslm-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="regression-모델.html#cb54-1" aria-hidden="true" tabindex="-1"></a>student.ts.lm <span class="ot">&lt;-</span> <span class="fu">tslm</span>(students.total.ts[,<span class="dv">5</span>] <span class="sc">~</span> <span class="sc">+</span> trend, <span class="at">data =</span> students.total.ts)  <span class="co"># 초등학생 학생수를 예측모델에 독립변수로 트랜드를 사용하는 선형 모델을 생성</span></span>
<span id="cb54-2"><a href="regression-모델.html#cb54-2" aria-hidden="true" tabindex="-1"></a>student.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">22</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="t_files/figure-html/tslm-2.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="regression-모델.html#cb55-1" aria-hidden="true" tabindex="-1"></a>student.ts.lm <span class="ot">&lt;-</span> <span class="fu">tslm</span>(students.total.ts[,<span class="dv">5</span>] <span class="sc">~</span> students.total.ts[,<span class="dv">4</span>] <span class="sc">+</span> trend, <span class="at">data =</span> students.total.ts)  <span class="co"># 초등학생 학생수를 예측모델에 독립변수로 유치원 학생수와 트랜드를 사용하는 선형 모델을 생성</span></span>
<span id="cb55-2"><a href="regression-모델.html#cb55-2" aria-hidden="true" tabindex="-1"></a>student.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">22</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="t_files/figure-html/tslm-3.png" width="672" /></p>
<p>위의 예제에서 사용한 데이터는 연도별 학생수의 합계이다. 이 데이터와 같은 연도별 데이터는 계절성이 존재하지 않기 때문에 season 키워드를 사용하면 아래와 같이 에러를 낸다.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="regression-모델.html#cb56-1" aria-hidden="true" tabindex="-1"></a>student.ts.lm <span class="ot">&lt;-</span> <span class="fu">tslm</span>(students.total.ts[,<span class="dv">3</span>] <span class="sc">~</span> trend <span class="sc">+</span> season, <span class="at">data =</span> students.total.ts)</span></code></pre></div>
<pre><code>## Error in tslm(students.total.ts[, 3] ~ trend + season, data = students.total.ts): Non-seasonal data cannot be modelled using a seasonal factor</code></pre>
<p>전체 취업자수와 교육서비스업 취업자수에 대한 선형회귀분석 모델과 plot은 다음과 같다.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="regression-모델.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 취업자수를 추세(trend)만으로 선형 회귀분석</span></span>
<span id="cb58-2"><a href="regression-모델.html#cb58-2" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="ot">&lt;-</span> <span class="fu">tslm</span>(employees.ts[,<span class="dv">2</span>] <span class="sc">~</span> trend, <span class="at">data =</span> employees.ts)</span>
<span id="cb58-3"><a href="regression-모델.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(employee.total.ts.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## tslm(formula = employees.ts[, 2] ~ trend, data = employees.ts)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1256.4  -264.1   119.9   350.6   525.7 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 25430.605     85.545  297.28   &lt;2e-16 ***
## trend          20.394      1.531   13.32   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 415.8 on 94 degrees of freedom
## Multiple R-squared:  0.6536, Adjusted R-squared:  0.6499 
## F-statistic: 177.3 on 1 and 94 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="regression-모델.html#cb60-1" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>()  <span class="co"># tslm 함수로 생성된 모델을 forecast()함수를 통해 예측값을 생성</span></span></code></pre></div>
<pre><code>##          Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
## Jan 2021       27408.79 26860.89 27956.69 26565.89 28251.69
## Feb 2021       27429.18 26880.94 27977.43 26585.75 28272.62
## Mar 2021       27449.58 26900.97 27998.18 26605.59 28293.56
## Apr 2021       27469.97 26921.01 28018.94 26625.43 28314.51
## May 2021       27490.36 26941.03 28039.70 26645.25 28335.48
## Jun 2021       27510.76 26961.05 28060.47 26665.07 28356.45
## Jul 2021       27531.15 26981.06 28081.25 26684.87 28377.43
## Aug 2021       27551.55 27001.06 28102.03 26704.66 28398.43
## Sep 2021       27571.94 27021.06 28122.82 26724.45 28419.43
## Oct 2021       27592.33 27041.05 28143.62 26744.22 28440.45</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="regression-모델.html#cb62-1" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>() <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="t_files/figure-html/tslm1-1.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="regression-모델.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 취업자수를 추세(trend)와 계절성(season)으로 선형 회귀분석</span></span>
<span id="cb63-2"><a href="regression-모델.html#cb63-2" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="ot">&lt;-</span> <span class="fu">tslm</span>(employees.ts[,<span class="dv">2</span>] <span class="sc">~</span> trend <span class="sc">+</span> season, <span class="at">data =</span> employees.ts)</span>
<span id="cb63-3"><a href="regression-모델.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(employee.total.ts.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## tslm(formula = employees.ts[, 2] ~ trend + season, data = employees.ts)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -675.70  -42.60   76.66  147.08  312.95 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 24850.616     96.043 258.744  &lt; 2e-16 ***
## trend          19.457      0.919  21.171  &lt; 2e-16 ***
## season2         1.168    123.798   0.009  0.99249    
## season3       318.462    123.808   2.572  0.01189 *  
## season4       629.005    123.825   5.080 2.29e-06 ***
## season5       869.174    123.849   7.018 5.63e-10 ***
## season6       919.342    123.880   7.421 9.13e-11 ***
## season7       935.260    123.918   7.547 5.14e-11 ***
## season8       803.429    123.962   6.481 6.13e-09 ***
## season9       854.597    124.013   6.891 9.94e-10 ***
## season10      890.516    124.071   7.177 2.75e-10 ***
## season11      898.809    124.135   7.241 2.07e-10 ***
## season12      385.477    124.207   3.104  0.00261 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 247.6 on 83 degrees of freedom
## Multiple R-squared:  0.8915, Adjusted R-squared:  0.8759 
## F-statistic: 56.86 on 12 and 83 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="regression-모델.html#cb65-1" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>()  <span class="co"># tslm 함수로 생성된 모델을 forecast()함수를 통해 예측값을 생성</span></span></code></pre></div>
<pre><code>##          Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
## Jan 2021       26737.91 26392.65 27083.16 26206.34 27269.47
## Feb 2021       26758.53 26413.28 27103.78 26226.97 27290.09
## Mar 2021       27095.28 26750.03 27440.53 26563.72 27626.84
## Apr 2021       27425.28 27080.03 27770.53 26893.72 27956.84
## May 2021       27684.91 27339.65 28030.16 27153.34 28216.47
## Jun 2021       27754.53 27409.28 28099.78 27222.97 28286.09
## Jul 2021       27789.91 27444.65 28135.16 27258.34 28321.47
## Aug 2021       27677.53 27332.28 28022.78 27145.97 28209.09
## Sep 2021       27748.16 27402.90 28093.41 27216.59 28279.72
## Oct 2021       27803.53 27458.28 28148.78 27271.97 28335.09</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="regression-모델.html#cb67-1" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>() <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="t_files/figure-html/tslm1-2.png" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="regression-모델.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 교육분야 취업자수를 추세(trend)와 계절성(season)으로 선형 회귀분석</span></span>
<span id="cb68-2"><a href="regression-모델.html#cb68-2" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="ot">&lt;-</span> <span class="fu">tslm</span>(employees.ts[,<span class="dv">3</span>] <span class="sc">~</span> trend <span class="sc">+</span> season, <span class="at">data =</span> employees.ts)</span>
<span id="cb68-3"><a href="regression-모델.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(employee.total.ts.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## tslm(formula = employees.ts[, 3] ~ trend + season, data = employees.ts)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -106.764  -21.988    6.553   23.192  102.373 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1789.2983    19.0207  94.071   &lt;2e-16 ***
## trend          0.5628     0.1820   3.092   0.0027 ** 
## season2       -7.5628    24.5174  -0.308   0.7585    
## season3        6.7493    24.5194   0.275   0.7838    
## season4       19.0615    24.5228   0.777   0.4392    
## season5       32.3737    24.5275   1.320   0.1905    
## season6       41.3108    24.5336   1.684   0.0960 .  
## season7       41.2480    24.5410   1.681   0.0966 .  
## season8       31.0602    24.5498   1.265   0.2093    
## season9       33.1224    24.5599   1.349   0.1811    
## season10      33.0595    24.5714   1.345   0.1821    
## season11      36.3717    24.5842   1.479   0.1428    
## season12      27.5589    24.5983   1.120   0.2658    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 49.03 on 83 degrees of freedom
## Multiple R-squared:  0.204,  Adjusted R-squared:  0.0889 
## F-statistic: 1.772 on 12 and 83 DF,  p-value: 0.06634</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="regression-모델.html#cb70-1" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>()  <span class="co"># tslm 함수로 생성된 모델을 forecast()함수를 통해 예측값을 생성</span></span></code></pre></div>
<pre><code>##          Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
## Jan 2021       1843.893 1775.518 1912.268 1738.621 1949.165
## Feb 2021       1836.893 1768.518 1905.268 1731.621 1942.165
## Mar 2021       1851.768 1783.393 1920.143 1746.496 1957.040
## Apr 2021       1864.643 1796.268 1933.018 1759.371 1969.915
## May 2021       1878.518 1810.143 1946.893 1773.246 1983.790
## Jun 2021       1888.018 1819.643 1956.393 1782.746 1993.290
## Jul 2021       1888.518 1820.143 1956.893 1783.246 1993.790
## Aug 2021       1878.893 1810.518 1947.268 1773.621 1984.165
## Sep 2021       1881.518 1813.143 1949.893 1776.246 1986.790
## Oct 2021       1882.018 1813.643 1950.393 1776.746 1987.290</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="regression-모델.html#cb72-1" aria-hidden="true" tabindex="-1"></a>employee.total.ts.lm <span class="sc">%&gt;%</span> <span class="fu">forecast</span>() <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="t_files/figure-html/tslm1-3.png" width="672" /></p>
<p>선형 회귀분석을 시행할 때 주의해야 할 점은 잔차가 백색 잡음이어야 한다는 점이다. 잔차의 자가회귀성이 존재하는 경우는 시계열적 특성을 여전히 지니고 있기 때문에 이를 제거할 필요가 있다. 다만 이 예측은 ‘잘못된’ 것은 아니나 예측구간이 커지기 때문에 비효율적 예측 모델이 된다.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<p>아래의 예에서 보면 전체 학생수를 추세에 의해 선형 회귀분석을 시행한 경우 잔차는 자기 상관성을 지니고 있음을 볼 수 있다. checkresiduals() 함수를 사용하여 확인하는데 plot만 봐도 백색잡음이 아님을 확인할 수 있지만 백색잡음 테스트인 Breusch-Godfrey 테스트 결과(checkresiduals() 함수는 회귀모델에 대해서는 Breusch-Godfrey 테스트를, 나머지는 Ljung-Box 테스트를 시행한다.)의 p-value가 0.05보다 작기 때문에 자기상관성이 존재하여 백색잡음으로 볼 수 없다.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="regression-모델.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(<span class="fu">tslm</span>(students.total.ts[,<span class="dv">3</span>] <span class="sc">~</span> trend, <span class="at">data =</span> students.total.ts))</span></code></pre></div>
<p><img src="t_files/figure-html/tslm_resid-1.png" width="672" /></p>
<pre><code>## 
##  Breusch-Godfrey test for serial correlation of order up to 5
## 
## data:  Residuals from Linear regression model
## LM test = 16.435, df = 5, p-value = 0.005707</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="regression-모델.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(<span class="fu">tslm</span>(students.total.ts[,<span class="dv">5</span>] <span class="sc">~</span> <span class="sc">+</span> trend, <span class="at">data =</span> students.total.ts))</span></code></pre></div>
<p><img src="t_files/figure-html/tslm_resid2-1.png" width="672" /></p>
<pre><code>## 
##  Breusch-Godfrey test for serial correlation of order up to 5
## 
## data:  Residuals from Linear regression model
## LM test = 16.827, df = 5, p-value = 0.004839</code></pre>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p>이기준 외, 인구지형변화에 따른 머신러닝 기반 고등교육 계열별 수요예측 모형 개발(2020), 한국교육개발원<a href="regression-모델.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p><a href="https://otexts.com/fppkr/regression-evaluation.html" class="uri">https://otexts.com/fppkr/regression-evaluation.html</a><a href="regression-모델.html#fnref9" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-모델링-알고리즘.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exponential-smoothing-모델.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["t.pdf", "t.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
