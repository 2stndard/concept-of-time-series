<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1 시계열 데이터 정보 다루기 | Untitled</title>
  <meta name="description" content="4.1 시계열 데이터 정보 다루기 | Untitled" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1 시계열 데이터 정보 다루기 | Untitled" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1 시계열 데이터 정보 다루기 | Untitled" />
  
  
  

<meta name="author" content="이기준" />


<meta name="date" content="2021-02-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="시계열-데이터-handling.html"/>
<link rel="next" href="시계열-데이터-실응용-사례.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">교육, 고용, 코로나 데이터를 활용한 시계열 데이터 분석 in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 시계열 데이터</a>
<ul>
<li class="chapter" data-level="1.1" data-path="시계열-데이터란.html"><a href="시계열-데이터란.html"><i class="fa fa-check"></i><b>1.1</b> 시계열 데이터란?</a></li>
<li class="chapter" data-level="1.2" data-path="시계열-데이터의-특성.html"><a href="시계열-데이터의-특성.html"><i class="fa fa-check"></i><b>1.2</b> 시계열 데이터의 특성</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="시계열-데이터의-특성.html"><a href="시계열-데이터의-특성.html#고정된-시간-독립변수"><i class="fa fa-check"></i><b>1.2.1</b> 고정된 시간 독립변수</a></li>
<li class="chapter" data-level="1.2.2" data-path="시계열-데이터의-특성.html"><a href="시계열-데이터의-특성.html#자기-상관관계"><i class="fa fa-check"></i><b>1.2.2</b> 자기 상관관계</a></li>
<li class="chapter" data-level="1.2.3" data-path="시계열-데이터의-특성.html"><a href="시계열-데이터의-특성.html#추세-경향성trend"><i class="fa fa-check"></i><b>1.2.3</b> 추세 경향성(Trend)</a></li>
<li class="chapter" data-level="1.2.4" data-path="시계열-데이터의-특성.html"><a href="시계열-데이터의-특성.html#계절성seasonality-순환성cyclic"><i class="fa fa-check"></i><b>1.2.4</b> 계절성(Seasonality), 순환성(Cyclic)</a></li>
<li class="chapter" data-level="1.2.5" data-path="시계열-데이터의-특성.html"><a href="시계열-데이터의-특성.html#불확실성uncertainty"><i class="fa fa-check"></i><b>1.2.5</b> 불확실성(Uncertainty)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="시계열-데이터-타입-및-import.html"><a href="시계열-데이터-타입-및-import.html"><i class="fa fa-check"></i><b>2</b> 시계열 데이터 타입 및 Import</a>
<ul>
<li class="chapter" data-level="2.1" data-path="날짜시간-데이터-클래스.html"><a href="날짜시간-데이터-클래스.html"><i class="fa fa-check"></i><b>2.1</b> 날짜/시간 데이터 클래스</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="날짜시간-데이터-클래스.html"><a href="날짜시간-데이터-클래스.html#date-클래스"><i class="fa fa-check"></i><b>2.1.1</b> date 클래스</a></li>
<li class="chapter" data-level="2.1.2" data-path="날짜시간-데이터-클래스.html"><a href="날짜시간-데이터-클래스.html#posixct-posixlt-data-class"><i class="fa fa-check"></i><b>2.1.2</b> POSIXct, POSIXlt data class</a></li>
<li class="chapter" data-level="2.1.3" data-path="날짜시간-데이터-클래스.html"><a href="날짜시간-데이터-클래스.html#yearmon-yearqtr-class"><i class="fa fa-check"></i><b>2.1.3</b> yearmon, yearqtr class</a></li>
<li class="chapter" data-level="2.1.4" data-path="날짜시간-데이터-클래스.html"><a href="날짜시간-데이터-클래스.html#날짜-시간-포맷"><i class="fa fa-check"></i><b>2.1.4</b> 날짜, 시간 포맷</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="시계열-데이터-객체object.html"><a href="시계열-데이터-객체object.html"><i class="fa fa-check"></i><b>2.2</b> 시계열 데이터 객체(Object)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="시계열-데이터-객체object.html"><a href="시계열-데이터-객체object.html#ts-r-basestats"><i class="fa fa-check"></i><b>2.2.1</b> ts : R base(stats)</a></li>
<li class="chapter" data-level="2.2.2" data-path="시계열-데이터-객체object.html"><a href="시계열-데이터-객체object.html#xts"><i class="fa fa-check"></i><b>2.2.2</b> xts</a></li>
<li class="chapter" data-level="2.2.3" data-path="시계열-데이터-객체object.html"><a href="시계열-데이터-객체object.html#tsibble"><i class="fa fa-check"></i><b>2.2.3</b> tsibble</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="시계열-데이터-import.html"><a href="시계열-데이터-import.html"><i class="fa fa-check"></i><b>2.3</b> 시계열 데이터 Import</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="시계열-데이터-import.html"><a href="시계열-데이터-import.html#엑셀-파일"><i class="fa fa-check"></i><b>2.3.1</b> 엑셀 파일</a></li>
<li class="chapter" data-level="2.3.2" data-path="시계열-데이터-import.html"><a href="시계열-데이터-import.html#csv-파일"><i class="fa fa-check"></i><b>2.3.2</b> CSV 파일</a></li>
<li class="chapter" data-level="2.3.3" data-path="시계열-데이터-import.html"><a href="시계열-데이터-import.html#추가-실습-데이터-생성"><i class="fa fa-check"></i><b>2.3.3</b> 추가 실습 데이터 생성</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="시계열-visualization.html"><a href="시계열-visualization.html"><i class="fa fa-check"></i><b>3</b> 시계열 Visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-frame-ggplot2-패키지.html"><a href="data-frame-ggplot2-패키지.html"><i class="fa fa-check"></i><b>3.1</b> data.frame : ggplot2 패키지</a></li>
<li class="chapter" data-level="3.2" data-path="xts-xts-패키지.html"><a href="xts-xts-패키지.html"><i class="fa fa-check"></i><b>3.2</b> xts : xts 패키지</a></li>
<li class="chapter" data-level="3.3" data-path="ts-forecast-패키지.html"><a href="ts-forecast-패키지.html"><i class="fa fa-check"></i><b>3.3</b> ts : forecast 패키지</a></li>
<li class="chapter" data-level="3.4" data-path="tsibble-feasts-패키지.html"><a href="tsibble-feasts-패키지.html"><i class="fa fa-check"></i><b>3.4</b> tsibble : feasts 패키지</a></li>
<li class="chapter" data-level="3.5" data-path="data-frame-timetk-패키지.html"><a href="data-frame-timetk-패키지.html"><i class="fa fa-check"></i><b>3.5</b> data.frame : timetk 패키지</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="시계열-데이터-handling.html"><a href="시계열-데이터-handling.html"><i class="fa fa-check"></i><b>4</b> 시계열 데이터 Handling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html"><i class="fa fa-check"></i><b>4.1</b> 시계열 데이터 정보 다루기</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html#시간-정보-추출-오늘-몇일이야"><i class="fa fa-check"></i><b>4.1.1</b> 시간 정보 추출 : 오늘 몇일이야?</a></li>
<li class="chapter" data-level="4.1.2" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html#시간-기간-연산-몇일-지났어"><i class="fa fa-check"></i><b>4.1.2</b> 시간 기간 연산 : 몇일 지났어?</a></li>
<li class="chapter" data-level="4.1.3" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html#시간-반올림-이번주-마지막날은-몇일이야"><i class="fa fa-check"></i><b>4.1.3</b> 시간 반올림 : 이번주 마지막날은 몇일이야?</a></li>
<li class="chapter" data-level="4.1.4" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html#시간-grouping-주간-월간-데이터는"><i class="fa fa-check"></i><b>4.1.4</b> 시간 Grouping : 주간, 월간 데이터는?</a></li>
<li class="chapter" data-level="4.1.5" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html#ohlc-주식-시가-고가-저가-종가는-어떻게-구해"><i class="fa fa-check"></i><b>4.1.5</b> OHLC : 주식 시가, 고가, 저가, 종가는 어떻게 구해?</a></li>
<li class="chapter" data-level="4.1.6" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html#시계열-데이터-rolling"><i class="fa fa-check"></i><b>4.1.6</b> 시계열 데이터 Rolling</a></li>
<li class="chapter" data-level="4.1.7" data-path="시계열-데이터-정보-다루기.html"><a href="시계열-데이터-정보-다루기.html#시간-조건-filtering-몇일부터-몇일까지-데이터는"><i class="fa fa-check"></i><b>4.1.7</b> 시간 조건 Filtering : 몇일부터 몇일까지 데이터는?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="시계열-데이터-실응용-사례.html"><a href="시계열-데이터-실응용-사례.html"><i class="fa fa-check"></i><b>4.2</b> 시계열 데이터 실응용 사례</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="시계열-데이터-실응용-사례.html"><a href="시계열-데이터-실응용-사례.html#월별-분기별-연별-합계"><i class="fa fa-check"></i><b>4.2.1</b> 월별, 분기별, 연별 합계</a></li>
<li class="chapter" data-level="4.2.2" data-path="시계열-데이터-실응용-사례.html"><a href="시계열-데이터-실응용-사례.html#월별-분기별-연별-증감량"><i class="fa fa-check"></i><b>4.2.2</b> 월별, 분기별, 연별 증감량</a></li>
<li class="chapter" data-level="4.2.3" data-path="시계열-데이터-실응용-사례.html"><a href="시계열-데이터-실응용-사례.html#월-비중-백분율-연-비중-백분율"><i class="fa fa-check"></i><b>4.2.3</b> 월 비중 백분율, 연 비중 백분율</a></li>
<li class="chapter" data-level="4.2.4" data-path="시계열-데이터-실응용-사례.html"><a href="시계열-데이터-실응용-사례.html#월별-분기별-연별-누적합계"><i class="fa fa-check"></i><b>4.2.4</b> 월별, 분기별, 연별 누적합계</a></li>
<li class="chapter" data-level="4.2.5" data-path="시계열-데이터-실응용-사례.html"><a href="시계열-데이터-실응용-사례.html#동월별-동분기별-동년별-plot"><i class="fa fa-check"></i><b>4.2.5</b> 동월별, 동분기별, 동년별 Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="시계열-forecasting-part-i-기초컨셉.html"><a href="시계열-forecasting-part-i-기초컨셉.html"><i class="fa fa-check"></i><b>5</b> 시계열 forecasting Part I - 기초컨셉</a>
<ul>
<li class="chapter" data-level="5.1" data-path="정상성stationary-비정상성non-stationary.html"><a href="정상성stationary-비정상성non-stationary.html"><i class="fa fa-check"></i><b>5.1</b> 정상성(Stationary), 비정상성(Non-Stationary)</a></li>
<li class="chapter" data-level="5.2" data-path="지연lag와-차분difference.html"><a href="지연lag와-차분difference.html"><i class="fa fa-check"></i><b>5.2</b> 지연(Lag)와 차분(Difference)</a></li>
<li class="chapter" data-level="5.3" data-path="acf와-pacf.html"><a href="acf와-pacf.html"><i class="fa fa-check"></i><b>5.3</b> ACF와 PACF</a></li>
<li class="chapter" data-level="5.4" data-path="적합값fitted-value-와-잔차residuals.html"><a href="적합값fitted-value-와-잔차residuals.html"><i class="fa fa-check"></i><b>5.4</b> 적합값(fitted value) 와 잔차(residuals)</a></li>
<li class="chapter" data-level="5.5" data-path="백색-잡음white-noise.html"><a href="백색-잡음white-noise.html"><i class="fa fa-check"></i><b>5.5</b> 백색 잡음(White Noise)</a></li>
<li class="chapter" data-level="5.6" data-path="시계열-분해decomposition.html"><a href="시계열-분해decomposition.html"><i class="fa fa-check"></i><b>5.6</b> 시계열 분해(Decomposition)</a></li>
<li class="chapter" data-level="5.7" data-path="정상성-테스트.html"><a href="정상성-테스트.html"><i class="fa fa-check"></i><b>5.7</b> 정상성 테스트</a></li>
<li class="chapter" data-level="5.8" data-path="계절성-ploting과-테스트.html"><a href="계절성-ploting과-테스트.html"><i class="fa fa-check"></i><b>5.8</b> 계절성 ploting과 테스트</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="시계열-forecasting-part-ii-시계열-예측-모델.html"><a href="시계열-forecasting-part-ii-시계열-예측-모델.html"><i class="fa fa-check"></i><b>6</b> 시계열 forecasting Part II - 시계열 예측 모델</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simple-모델.html"><a href="simple-모델.html"><i class="fa fa-check"></i><b>6.1</b> Simple 모델</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="simple-모델.html"><a href="simple-모델.html#평균-모델forecastmeanf"><i class="fa fa-check"></i><b>6.1.1</b> 평균 모델(forecast::meanf)</a></li>
<li class="chapter" data-level="6.1.2" data-path="simple-모델.html"><a href="simple-모델.html#단순naive-모델"><i class="fa fa-check"></i><b>6.1.2</b> 단순(Naive) 모델</a></li>
<li class="chapter" data-level="6.1.3" data-path="simple-모델.html"><a href="simple-모델.html#계절성-단순seasonal-naive-모델"><i class="fa fa-check"></i><b>6.1.3</b> 계절성 단순(Seasonal Naive) 모델</a></li>
<li class="chapter" data-level="6.1.4" data-path="simple-모델.html"><a href="simple-모델.html#random-work-모델"><i class="fa fa-check"></i><b>6.1.4</b> Random Work 모델</a></li>
<li class="chapter" data-level="6.1.5" data-path="simple-모델.html"><a href="simple-모델.html#simple-모델-비교"><i class="fa fa-check"></i><b>6.1.5</b> Simple 모델 비교</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regression-모델.html"><a href="regression-모델.html"><i class="fa fa-check"></i><b>6.2</b> Regression 모델</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="regression-모델.html"><a href="regression-모델.html#tslm-함수forecast-패키지"><i class="fa fa-check"></i><b>6.2.1</b> tslm 함수(forecast 패키지)</a></li>
<li class="chapter" data-level="6.2.2" data-path="regression-모델.html"><a href="regression-모델.html#plot_time_series_regression-함수timetk-패키지"><i class="fa fa-check"></i><b>6.2.2</b> plot_time_series_regression 함수(timetk 패키지)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="지수-평활exponential-smoothing-모델.html"><a href="지수-평활exponential-smoothing-모델.html"><i class="fa fa-check"></i><b>6.3</b> 지수 평활(Exponential Smoothing) 모델</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="지수-평활exponential-smoothing-모델.html"><a href="지수-평활exponential-smoothing-모델.html#단순-지수-평활-모델simple-exponentail-smoothing-model"><i class="fa fa-check"></i><b>6.3.1</b> 단순 지수 평활 모델(Simple Exponentail Smoothing Model)</a></li>
<li class="chapter" data-level="6.3.2" data-path="지수-평활exponential-smoothing-모델.html"><a href="지수-평활exponential-smoothing-모델.html#홀트holt-모델"><i class="fa fa-check"></i><b>6.3.2</b> 홀트(Holt) 모델</a></li>
<li class="chapter" data-level="6.3.3" data-path="지수-평활exponential-smoothing-모델.html"><a href="지수-평활exponential-smoothing-모델.html#홀트-윈터holt-winter-모델"><i class="fa fa-check"></i><b>6.3.3</b> 홀트-윈터(Holt-Winter) 모델</a></li>
<li class="chapter" data-level="6.3.4" data-path="지수-평활exponential-smoothing-모델.html"><a href="지수-평활exponential-smoothing-모델.html#ets-모델"><i class="fa fa-check"></i><b>6.3.4</b> ETS 모델</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="arima-모델.html"><a href="arima-모델.html"><i class="fa fa-check"></i><b>6.4</b> ARIMA 모델</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="arima-모델.html"><a href="arima-모델.html#자기회귀모델autoregressive-model"><i class="fa fa-check"></i><b>6.4.1</b> 자기회귀모델(AutoRegressive Model)</a></li>
<li class="chapter" data-level="6.4.2" data-path="arima-모델.html"><a href="arima-모델.html#이동평균-모델moving-average-model"><i class="fa fa-check"></i><b>6.4.2</b> 이동평균 모델(Moving Average Model)</a></li>
<li class="chapter" data-level="6.4.3" data-path="arima-모델.html"><a href="arima-모델.html#arima-모델-결정"><i class="fa fa-check"></i><b>6.4.3</b> ARIMA 모델 결정</a></li>
<li class="chapter" data-level="6.4.4" data-path="arima-모델.html"><a href="arima-모델.html#seasonal-arima-모델"><i class="fa fa-check"></i><b>6.4.4</b> Seasonal ARIMA 모델</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tbats-모델.html"><a href="tbats-모델.html"><i class="fa fa-check"></i><b>6.5</b> TBATs 모델</a></li>
<li class="chapter" data-level="6.6" data-path="prophet-모델.html"><a href="prophet-모델.html"><i class="fa fa-check"></i><b>6.6</b> prophet 모델</a></li>
<li class="chapter" data-level="6.7" data-path="neural-network-모델.html"><a href="neural-network-모델.html"><i class="fa fa-check"></i><b>6.7</b> Neural Network 모델</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="시계열-forecasting-part-iii-시계열-분석-framework.html"><a href="시계열-forecasting-part-iii-시계열-분석-framework.html"><i class="fa fa-check"></i><b>7</b> 시계열 forecasting Part III - 시계열 분석 Framework</a>
<ul>
<li class="chapter" data-level="7.1" data-path="성능분석-지수.html"><a href="성능분석-지수.html"><i class="fa fa-check"></i><b>7.1</b> 성능분석 지수</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="성능분석-지수.html"><a href="성능분석-지수.html#rmseroot-means-squaread-error"><i class="fa fa-check"></i><b>7.1.1</b> RMSE(Root Means Squaread Error)</a></li>
<li class="chapter" data-level="7.1.2" data-path="성능분석-지수.html"><a href="성능분석-지수.html#mae"><i class="fa fa-check"></i><b>7.1.2</b> MAE</a></li>
<li class="chapter" data-level="7.1.3" data-path="성능분석-지수.html"><a href="성능분석-지수.html#mpe"><i class="fa fa-check"></i><b>7.1.3</b> MPE</a></li>
<li class="chapter" data-level="7.1.4" data-path="성능분석-지수.html"><a href="성능분석-지수.html#mape"><i class="fa fa-check"></i><b>7.1.4</b> MAPE</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="fable-framework.html"><a href="fable-framework.html"><i class="fa fa-check"></i><b>7.2</b> fable framework</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="fable-framework.html"><a href="fable-framework.html#미래-학생수-예측"><i class="fa fa-check"></i><b>7.2.1</b> 미래 학생수 예측</a></li>
<li class="chapter" data-level="7.2.2" data-path="fable-framework.html"><a href="fable-framework.html#미래-취업자수-예측"><i class="fa fa-check"></i><b>7.2.2</b> 미래 취업자수 예측</a></li>
<li class="chapter" data-level="7.2.3" data-path="fable-framework.html"><a href="fable-framework.html#미래-코로나-확진자수-예측"><i class="fa fa-check"></i><b>7.2.3</b> 미래 코로나 확진자수 예측</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modeltime.html"><a href="modeltime.html"><i class="fa fa-check"></i><b>7.3</b> modeltime</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="modeltime.html"><a href="modeltime.html#미래-학생수-예측-1"><i class="fa fa-check"></i><b>7.3.1</b> 미래 학생수 예측</a></li>
<li class="chapter" data-level="7.3.2" data-path="modeltime.html"><a href="modeltime.html#미래-취업자수-예측-1"><i class="fa fa-check"></i><b>7.3.2</b> 미래 취업자수 예측</a></li>
<li class="chapter" data-level="7.3.3" data-path="modeltime.html"><a href="modeltime.html#미래-코로나-확진자수-예측-1"><i class="fa fa-check"></i><b>7.3.3</b> 미래 코로나 확진자수 예측</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="7.4" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>7.4</b> R Markdown</a></li>
<li class="chapter" data-level="7.5" data-path="including-plots.html"><a href="including-plots.html"><i class="fa fa-check"></i><b>7.5</b> Including Plots</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Untitled</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="시계열-데이터-정보-다루기" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> 시계열 데이터 정보 다루기</h2>
<div id="시간-정보-추출-오늘-몇일이야" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> 시간 정보 추출 : 오늘 몇일이야?</h3>
<p>시계열 데이터는 년, 월, 일, 시, 분, 초, 타임존 등의 여러 데이터가 결합되어 생성된 시간을 인덱스로 사용하는 데이터이다. 그래서 시계열 데이터를 잘 활용하기 위해서는 시간 인덱스에 포함된 요소들을 목적에 맞게 적절히 추출해내야 활용이 가능해진다.</p>
<table>
<thead>
<tr class="header">
<th>함수명</th>
<th>설명</th>
<th>함수명</th>
<th>설명</th>
<th>함수명</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>year()</td>
<td>연도 추출</td>
<td>hour()</td>
<td>시간 추출</td>
<td>week()</td>
<td>1월1일으로부터의 주수</td>
</tr>
<tr class="even">
<td>month()</td>
<td>월 추출</td>
<td>minute()</td>
<td>분 추출</td>
<td>quater(), semester()</td>
<td>1월1일으로부터의 분기수, 반기수</td>
</tr>
<tr class="odd">
<td>day()</td>
<td>일 추출</td>
<td>second()</td>
<td>초 추출</td>
<td>am(), pm()</td>
<td>오전, 오후의 논리값</td>
</tr>
<tr class="even">
<td>wday()</td>
<td>요일 추출</td>
<td>yday()</td>
<td>1월1일으로부터의 날수</td>
<td>leap_year()</td>
<td>윤년 여부의 논리값</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="시계열-데이터-정보-다루기.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-2"><a href="시계열-데이터-정보-다루기.html#cb1-2" aria-hidden="true" tabindex="-1"></a>now.date <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()  <span class="do">### 현재 시간을 now.date에 저장(date 클래스)</span></span>
<span id="cb1-3"><a href="시계열-데이터-정보-다루기.html#cb1-3" aria-hidden="true" tabindex="-1"></a>now.char <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">Sys.time</span>())  <span class="do">### 현재 시간을 now.char에 저장(character 클래스)</span></span>
<span id="cb1-4"><a href="시계열-데이터-정보-다루기.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&#39;오늘은 &#39;</span>, <span class="fu">year</span>(now.date), <span class="st">&#39;년 &#39;</span>, <span class="fu">month</span>(now.char), <span class="st">&#39;월 &#39;</span>, <span class="fu">day</span>(now.date), <span class="st">&#39;일 입니다&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;오늘은 2021년 2월 23일 입니다&quot;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="시계열-데이터-정보-다루기.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&#39;1월 1일부터 오늘까지 &#39;</span>, <span class="fu">yday</span>(now.date), <span class="st">&#39;일 지났습니다&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1월 1일부터 오늘까지 54일 지났습니다&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="시계열-데이터-정보-다루기.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&#39;이번 분기 시작일부터 오늘까지 &#39;</span>, <span class="fu">qday</span>(now.date), <span class="st">&#39;일 지났습니다&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;이번 분기 시작일부터 오늘까지 54일 지났습니다&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="시계열-데이터-정보-다루기.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&#39;오늘은 &#39;</span>, <span class="fu">wday</span>(now.date, <span class="at">label =</span> T, <span class="at">abbr =</span> T), <span class="st">&#39;요일입니다&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;오늘은 화요일입니다&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="시계열-데이터-정보-다루기.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&#39;지금은 &#39;</span>, <span class="fu">hour</span>(now.date), <span class="st">&#39;시 &#39;</span>, <span class="fu">minute</span>(now.char), <span class="st">&#39;분 &#39;</span>,  <span class="fu">second</span>(now.date), <span class="st">&#39;초 입니다&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;지금은 9시 46분 29.8556439876556초 입니다&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="시계열-데이터-정보-다루기.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&#39;이번주는 올해의 &#39;</span>, <span class="fu">week</span>(now.date), <span class="st">&#39;번째 주입니다&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;이번주는 올해의 8번째 주입니다&quot;</code></pre>
</div>
<div id="시간-기간-연산-몇일-지났어" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> 시간 기간 연산 : 몇일 지났어?</h3>
<p>시간의 연산은 일반적으로 오늘로부터 며칠후, 언제로부터 몇개월전 등과 같은 연산을 의미한다. 이번 절에서는 <code>lubridate</code> 패키지에서는 제공하는 시간 연산 함수들을 설명한다. 다만 앞선 장에서는 <code>ts</code> 와 <code>xts</code> 클래스의 시계열 객체는 본 절에서 다루는 시계열 데이터 연산 중 일부가 지원되지 않기 때문에 <code>data.frame</code>을 위주로 설명하겠다.</p>
<ul>
<li>시간 더하기/빼기</li>
</ul>
<p><code>lubridate</code> 패키지에서는 시간의 더하기나 빼기 연산을 지원한다. 일반적인 정수를 이용하여 더하거나 빼면 기준일로부터 과거나 미래를 산출할 수 있고 <code>lubridate</code>에서 제공하는 <code>years()</code>, <code>months()</code>, <code>days()</code> 등의 함수를 이용하면 년 단위, 월 단위, 일 단위의 연산도 가능하다.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="시계열-데이터-정보-다루기.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">&#39;2021-01-01&#39;</span>) <span class="sc">-</span> <span class="fu">as.Date</span>(<span class="st">&#39;1980-01-01&#39;</span>)  <span class="do">### 1980년 1월 1일부터 2021년 1월 1일까지의 날짜 수</span></span></code></pre></div>
<pre><code>## Time difference of 14976 days</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="시계열-데이터-정보-다루기.html#cb15-1" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">today</span>()</span>
<span id="cb15-2"><a href="시계열-데이터-정보-다루기.html#cb15-2" aria-hidden="true" tabindex="-1"></a>today <span class="sc">+</span> <span class="dv">100</span>   <span class="do">### 오늘부터 100일 후</span></span></code></pre></div>
<pre><code>## [1] &quot;2021-06-03&quot;</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="시계열-데이터-정보-다루기.html#cb17-1" aria-hidden="true" tabindex="-1"></a>today <span class="sc">-</span> <span class="fu">months</span>(<span class="dv">2</span>)  <span class="do">### 오늘부터 2개월 전  </span></span></code></pre></div>
<pre><code>## [1] &quot;2020-12-23&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="시계열-데이터-정보-다루기.html#cb19-1" aria-hidden="true" tabindex="-1"></a>today <span class="sc">-</span> <span class="fu">years</span>(<span class="dv">1</span>)   <span class="do">### 오늘부터 1년전</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-02-23&quot;</code></pre>
<ul>
<li>시간간 기간 구하기</li>
</ul>
<p>앞선 예에서 1980년 1월 1일부터 2021년 1월 1일까지는 14,976일로 계산되었다. 그러나 우리는 보통 몇년 몇월 몇일로 표현된다. <code>lubridate</code>에서는 이렇게 몇년 몇월 몇일로 변환하는 것을 <code>interval()</code>함수를 사용하여 계산한다. 하지만 바로 계산되는 것은 아니고 <code>interval()</code>함수에 의해 반환되는 값은<code>interval</code> 클래스의 데이터값으로 시작점으로부터의 초를 기록한다. 이렇게 변환된 <code>interval</code> 객체를 올바르게 표현하기 위해서는 <code>interva</code>l 객체를 <code>period</code> 나 <code>duration</code> 클래스 객체로 변환하여야 한다. <code>interval()</code>는 함수형태로 사용이 가능하고 <code>%–%</code> 연산자를 사용할 수도 있다.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="시계열-데이터-정보-다루기.html#cb21-1" aria-hidden="true" tabindex="-1"></a>int <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">interval</span>(<span class="fu">as.Date</span>(<span class="st">&#39;1980-01-01&#39;</span>), <span class="fu">as.Date</span>(<span class="st">&#39;2021-12-31&#39;</span>))   <span class="do">### 1980.1.1부터 2021.12.31까지의 interval 클래스를 int에 저장</span></span>
<span id="cb21-2"><a href="시계열-데이터-정보-다루기.html#cb21-2" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">as.period</span>(int)   <span class="do">### 년월일 형태로 interval 출력</span></span></code></pre></div>
<pre><code>## [1] &quot;41y 11m 30d 0H 0M 0S&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="시계열-데이터-정보-다루기.html#cb23-1" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">as.duration</span>(int)  <span class="do">### 경과 초 형태로 interval 출력</span></span></code></pre></div>
<pre><code>## [1] &quot;1325376000s (~42 years)&quot;</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="시계열-데이터-정보-다루기.html#cb25-1" aria-hidden="true" tabindex="-1"></a>int1 <span class="ot">&lt;-</span> <span class="st">&#39;1980-01-01&#39;</span> <span class="sc">%--%</span> <span class="st">&#39;2021-12-31&#39;</span></span>
<span id="cb25-2"><a href="시계열-데이터-정보-다루기.html#cb25-2" aria-hidden="true" tabindex="-1"></a>     <span class="do">### 1980.1.1부터 2021.12.31까지의 interval 클래스를 int1에 저장</span></span>
<span id="cb25-3"><a href="시계열-데이터-정보-다루기.html#cb25-3" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">as.period</span>(int1)   <span class="do">### 년월일 형태로 interval 출력</span></span></code></pre></div>
<pre><code>## [1] &quot;41y 11m 30d 0H 0M 0S&quot;</code></pre>
<p>위의 예제와 같이 <code>internal</code>은 시간 범위(time spans)를 표현하는데 <code>lubridate</code>는 <code>period</code>와 <code>duration</code>의 두가지 시간 범위(time spans) 클래스를 제공한다. <code>lubridate</code>에서 제공하는 <code>period</code>함수는 복수형태(<code>years()</code>,<code>months()</code> 등)로 표현된 함수를 사용하고 <code>duration</code> 함수는 함수의 접두어를 ’d’를 사용하여 표현한다.</p>
<p>두가지 형태의 <code>internal</code>을 제공하는 이유는 시간 경과의 표현과 기간 경과의 표현이 다르기 때문이다. <code>duration</code>은 항상 수학적으로 동일한 시간 경과의 결과를 제공한다. 하지만 <code>period</code>는 우리가 흔히 년월일로 생각하는 기간 경과의 결과를 제공한다. 예를 들어 <code>duration</code>의 1년 후는 시작일로부터 365일 후가 되는 날짜를 리턴하지만 <code>period</code>의 1년 후는 연도가 1이 더해진 날짜를 리턴한다. 두가지의 결과가 동일할 것이라고 생각되지만 윤년이 낀 경우는 <code>duration</code>의 결과는 <code>period</code>의 결과와 달라진다. 또 <code>duration</code> 함수에 정수 시퀀스를 넣어주면 해당 연산에 의한 vector값이 얻어진다.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="시계열-데이터-정보-다루기.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leap_year</span>(<span class="dv">2020</span>)   <span class="do">### 2020년은 윤년</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="시계열-데이터-정보-다루기.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">&#39;2020-01-01&#39;</span>) <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)  <span class="do">### 2020-01-01부터 기간상 1년 후(period)는 2021-01-01</span></span></code></pre></div>
<pre><code>## [1] &quot;2021-01-01&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="시계열-데이터-정보-다루기.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">&#39;2020-01-01&#39;</span>) <span class="sc">+</span> <span class="fu">dyears</span>(<span class="dv">1</span>)  <span class="do">### 2020-01-01부터 시간상 1년 후(duration)는 2020-12-31</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-12-31 06:00:00 UTC&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="시계열-데이터-정보-다루기.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">&#39;2021-02-01&#39;</span>) <span class="sc">+</span> <span class="fu">weeks</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)  <span class="do">### 2011-01-01부터 일주일씩 11주 같은 요일 날짜</span></span></code></pre></div>
<pre><code>## [1] &quot;2021-02-01&quot; &quot;2021-02-08&quot; &quot;2021-02-15&quot; &quot;2021-02-22&quot; &quot;2021-03-01&quot;
## [6] &quot;2021-03-08&quot;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="시계열-데이터-정보-다루기.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">&#39;2020-02-01&#39;</span>) <span class="sc">+</span> <span class="fu">dweeks</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)  <span class="do">### 2012-01-01부터 일주일씩 11주 같은 요일 날짜(윤년때문에 2021과 다르다)</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-02-01&quot; &quot;2020-02-08&quot; &quot;2020-02-15&quot; &quot;2020-02-22&quot; &quot;2020-02-29&quot;
## [6] &quot;2020-03-07&quot;</code></pre>
</div>
<div id="시간-반올림-이번주-마지막날은-몇일이야" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> 시간 반올림 : 이번주 마지막날은 몇일이야?</h3>
<p>시간의 계산에서도 숫자의 계산과 같이 올림, 내림, 반올림 등이 가능하다. 숫자의 계산에서는 소수점 세째자리, 천단위 반올림, 올림 등과 같이 반올림될 단위를 지정해야 하는데 시간의 올림, 반올림 연산에도 월에서 반올림을 할것인지 일에서 반올림을 할 것인지와 같은 단위를 지정해야 한다.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p><code>lubridate</code> 패키지에서는 시간 데이터의 반올림을 위해 <code>round_date()</code>, 내림을 위해 <code>floor_date()</code>, 올림을 위해 <code>ceiling_date()</code> 함수를 제공한다. 매개변수로 ‘day,’ ‘week,’ ‘month,’ ‘halfyear,’ ‘year’ 등을 설정하여 반올림, 올림, 내림의 기본 단위를 지정할 수 있다.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="시계열-데이터-정보-다루기.html#cb37-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2009-08-03&quot;</span>)</span>
<span id="cb37-2"><a href="시계열-데이터-정보-다루기.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round_date</span>(x, <span class="st">&quot;day&quot;</span>)         <span class="co"># 일단위로 반올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-08-03&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="시계열-데이터-정보-다루기.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">floor_date</span>(x, <span class="st">&quot;day&quot;</span>)         <span class="co"># 일단위로 내림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-08-03&quot;</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="시계열-데이터-정보-다루기.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling_date</span>(x, <span class="st">&quot;day&quot;</span>)       <span class="co"># 일단위로 올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-08-04&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="시계열-데이터-정보-다루기.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round_date</span>(x, <span class="st">&quot;week&quot;</span>)        <span class="co"># 주단위로 반올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-08-02&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="시계열-데이터-정보-다루기.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">floor_date</span>(x, <span class="st">&quot;week&quot;</span>)        <span class="co"># 주단위로 내림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-08-02&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="시계열-데이터-정보-다루기.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling_date</span>(x, <span class="st">&quot;week&quot;</span>)      <span class="co"># 주단위로 올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-08-09&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="시계열-데이터-정보-다루기.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round_date</span>(x, <span class="st">&quot;month&quot;</span>)       <span class="co"># 월단위로 반올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-08-01&quot;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="시계열-데이터-정보-다루기.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">floor_date</span>(x, <span class="st">&quot;month&quot;</span>)       <span class="co"># 월단위로 내림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-08-01&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="시계열-데이터-정보-다루기.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling_date</span>(x, <span class="st">&quot;month&quot;</span>)     <span class="co"># 월단위로 올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-09-01&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="시계열-데이터-정보-다루기.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round_date</span>(x, <span class="st">&quot;halfyear&quot;</span>)    <span class="co"># 반기단위로 반올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-07-01&quot;</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="시계열-데이터-정보-다루기.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">floor_date</span>(x, <span class="st">&quot;halfyear&quot;</span>)    <span class="co"># 반기 단위로 내림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-07-01&quot;</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="시계열-데이터-정보-다루기.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling_date</span>(x, <span class="st">&quot;halfyear&quot;</span>)  <span class="co"># 반기 단위로 올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2010-01-01&quot;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="시계열-데이터-정보-다루기.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round_date</span>(x, <span class="st">&quot;year&quot;</span>)        <span class="co"># 년단위로 반올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2010-01-01&quot;</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="시계열-데이터-정보-다루기.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">floor_date</span>(x, <span class="st">&quot;year&quot;</span>)        <span class="co"># 년단위로 내림</span></span></code></pre></div>
<pre><code>## [1] &quot;2009-01-01&quot;</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="시계열-데이터-정보-다루기.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling_date</span>(x, <span class="st">&quot;year&quot;</span>)      <span class="co"># 년단위로 올림</span></span></code></pre></div>
<pre><code>## [1] &quot;2010-01-01&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="시계열-데이터-정보-다루기.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">days_in_month</span>(<span class="fu">as.Date</span>(<span class="st">&#39;2012-2&#39;</span>, <span class="at">format =</span> <span class="st">&#39;%Y-%d&#39;</span>))  <span class="co"># 말일을 구하는 코드</span></span></code></pre></div>
<pre><code>## Feb 
##  29</code></pre>
</div>
<div id="시간-grouping-주간-월간-데이터는" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> 시간 Grouping : 주간, 월간 데이터는?</h3>
<p>시계열 데이터를 사용할 때 많이 사용하는 계산은 월별 평균, 주별 합계 등 일정 단위별로 그룹핑한 후 그룹함수를 적용하여 산출하는 작업이다.</p>
<p>아쉽게도 앞서 사용한 <code>lubridate</code> 패키지에서는 시계열 데이터를 주단위, 월단위, 년단위 등으로 그룹핑하는 함수를 제공하지 않는다. 따라서 <code>lubridate</code> 함수를 이용하여 그룹화하기 위해서는 <code>dplyr</code>에서 제공하는 파이프 연산자인 <code>%&gt;%</code>와 함수를 같이 사용하여 산출할 수 있다.</p>
<p>하지만 앞장에서 소개한 <code>timetk</code> 패키지에서는 그룹핑하여 평균을 내거나 합계를 내는 함수를 제공하기 때문에 이를 사용할 수도 있다.</p>
<p>이번 절에서는 <code>lubridate</code>와 <code>dplyr</code>를 사용하는 방법과 <code>timetk</code>를 사용하는 방법으로 분리해서 설명하겠다.</p>
<ul>
<li><code>lubridate</code>, <code>dplyr</code> 패키지</li>
</ul>
<p>먼저 그룹핑을 하기 위한 단위를 설정하기 위해 <code>lubridate</code> 패키지의 <code>year()</code>, <code>month()</code>, <code>week()</code> 등의 함수를 사용하여 해당 일의 년, 월, 주등을 산출하고 <code>mutate</code> 함수를 사용하여 컬럼으로 만들어준다. 다음 <code>group_by</code> 함수를 사용하여 데이터를 그룹핑하고 <code>summarise</code> 함수를 통해 <code>sum()</code>, <code>mean()</code> 등의 그룹 함수를 사용하여 원하는 값을 산출한다.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="시계열-데이터-정보-다루기.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb69-2"><a href="시계열-데이터-정보-다루기.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-3"><a href="시계열-데이터-정보-다루기.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="do">###  월별 취업자수를 연별 취업자수로 그룹핑</span></span>
<span id="cb69-4"><a href="시계열-데이터-정보-다루기.html#cb69-4" aria-hidden="true" tabindex="-1"></a>(employees.by.year <span class="ot">&lt;-</span> employees <span class="sc">%&gt;%</span> </span>
<span id="cb69-5"><a href="시계열-데이터-정보-다루기.html#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time)) <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="시계열-데이터-정보-다루기.html#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb69-7"><a href="시계열-데이터-정보-다루기.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total.year =</span> <span class="fu">sum</span>(total), </span>
<span id="cb69-8"><a href="시계열-데이터-정보-다루기.html#cb69-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">employees.edu =</span> <span class="fu">sum</span>(employees.edu)))</span></code></pre></div>
<pre><code>## # A tibble: 8 x 3
##    year total.year employees.edu
##   &lt;dbl&gt;      &lt;int&gt;         &lt;int&gt;
## 1  2013     303592         21192
## 2  2014     310766         21957
## 3  2015     314133         22028
## 4  2016     316910         22350
## 5  2017     320698         22886
## 6  2018     321866         22165
## 7  2019     325474         22600
## 8  2020     322852         21570</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="시계열-데이터-정보-다루기.html#cb71-1" aria-hidden="true" tabindex="-1"></a>employees.by.year <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="시계열-데이터-정보-다루기.html#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">as.factor</span>(year), total.year)) <span class="sc">+</span> </span>
<span id="cb71-3"><a href="시계열-데이터-정보-다루기.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb71-4"><a href="시계열-데이터-정보-다루기.html#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">number</span>(total.year, <span class="at">big.mark =</span> <span class="st">&#39;,&#39;</span>)), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb71-5"><a href="시계열-데이터-정보-다루기.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;연별 취업자수&#39;</span>, <span class="at">x =</span> <span class="st">&#39;연도&#39;</span>, <span class="at">y =</span> <span class="st">&#39;취업자수&#39;</span>) <span class="sc">+</span> </span>
<span id="cb71-6"><a href="시계열-데이터-정보-다루기.html#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">big.mark =</span> <span class="st">&#39;,&#39;</span>))</span></code></pre></div>
<p><img src="t_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="시계열-데이터-정보-다루기.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">###  일별 확진자수를 월별 확진자수로 그룹핑</span></span>
<span id="cb72-2"><a href="시계열-데이터-정보-다루기.html#cb72-2" aria-hidden="true" tabindex="-1"></a>covid19 <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="시계열-데이터-정보-다루기.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date), <span class="at">year =</span> <span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="시계열-데이터-정보-다루기.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, year) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="시계열-데이터-정보-다루기.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(total<span class="fl">.1</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span>), </span>
<span id="cb72-6"><a href="시계열-데이터-정보-다루기.html#cb72-6" aria-hidden="true" tabindex="-1"></a>            total<span class="fl">.10</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">10-19세</span><span class="st">`</span>), </span>
<span id="cb72-7"><a href="시계열-데이터-정보-다루기.html#cb72-7" aria-hidden="true" tabindex="-1"></a>            total<span class="fl">.20</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">20-29세</span><span class="st">`</span>), </span>
<span id="cb72-8"><a href="시계열-데이터-정보-다루기.html#cb72-8" aria-hidden="true" tabindex="-1"></a>            total<span class="fl">.30</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">30-39세</span><span class="st">`</span>), </span>
<span id="cb72-9"><a href="시계열-데이터-정보-다루기.html#cb72-9" aria-hidden="true" tabindex="-1"></a>            total<span class="fl">.40</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">40-49세</span><span class="st">`</span>), </span>
<span id="cb72-10"><a href="시계열-데이터-정보-다루기.html#cb72-10" aria-hidden="true" tabindex="-1"></a>            total<span class="fl">.50</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">50-59세</span><span class="st">`</span>), </span>
<span id="cb72-11"><a href="시계열-데이터-정보-다루기.html#cb72-11" aria-hidden="true" tabindex="-1"></a>            total<span class="fl">.60</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">60-69세</span><span class="st">`</span>), </span>
<span id="cb72-12"><a href="시계열-데이터-정보-다루기.html#cb72-12" aria-hidden="true" tabindex="-1"></a>            total<span class="fl">.70</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">70-79세</span><span class="st">`</span>), </span>
<span id="cb72-13"><a href="시계열-데이터-정보-다루기.html#cb72-13" aria-hidden="true" tabindex="-1"></a>            total<span class="fl">.80</span>대확진자 <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">80세 이상</span><span class="st">`</span>))</span></code></pre></div>
<pre><code>## # A tibble: 11 x 11
## # Groups:   month [11]
##    month  year total.1대확진자 total.10대확진자 total.20대확진자
##    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1     1  2021             893             1433             2241
##  2     2  2021             188               NA              412
##  3     4  2020              14               42              120
##  4     5  2020              16               62              214
##  5     6  2020              31               48              171
##  6     7  2020              53               74              258
##  7     8  2020             196              363              700
##  8     9  2020             136              161              442
##  9    10  2020             112              137              387
## 10    11  2020             301              593             1298
## 11    12  2020            1016             1589             3010
## # ... with 6 more variables: total.30대확진자 &lt;dbl&gt;, total.40대확진자 &lt;dbl&gt;,
## #   total.50대확진자 &lt;dbl&gt;, total.60대확진자 &lt;dbl&gt;, total.70대확진자 &lt;dbl&gt;,
## #   total.80대확진자 &lt;dbl&gt;</code></pre>
<p>또 하나의 방법은 tibbletime 패키지에서 제공하는 collapse_by() 함수를 사용하는 방법이다. collapse_by() 함수는 시간 인덱스열을 직접 컨트롤하여 매개변수로 전달된 기간마다 데이터를 접은(collapse) 후에 group_by() 함수를 이용해 그룹핑하여 기간별 데이터를 산출할 수 있다.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> 다만 collapse_by()함수를 사용하려면 tibbletime 패키지를 설치, 로딩해야하며 tbl_time 클래스 객체로 변환된 데이터 객체에 한해서 사용할 수 있다.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="시계열-데이터-정보-다루기.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibbletime)</span>
<span id="cb74-2"><a href="시계열-데이터-정보-다루기.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tbl_time</span>(covid19, <span class="at">index =</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="시계열-데이터-정보-다루기.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_by</span>(<span class="st">&#39;weekly&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="시계열-데이터-정보-다루기.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="시계열-데이터-정보-다루기.html#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">1대</span><span class="st">`</span><span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span>), </span>
<span id="cb74-6"><a href="시계열-데이터-정보-다루기.html#cb74-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">10대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">10-19세</span><span class="st">`</span>), </span>
<span id="cb74-7"><a href="시계열-데이터-정보-다루기.html#cb74-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">20대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">20-29세</span><span class="st">`</span>), </span>
<span id="cb74-8"><a href="시계열-데이터-정보-다루기.html#cb74-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">30대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">30-39세</span><span class="st">`</span>), </span>
<span id="cb74-9"><a href="시계열-데이터-정보-다루기.html#cb74-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">40대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">40-49세</span><span class="st">`</span>), </span>
<span id="cb74-10"><a href="시계열-데이터-정보-다루기.html#cb74-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">50대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">50-59세</span><span class="st">`</span>), </span>
<span id="cb74-11"><a href="시계열-데이터-정보-다루기.html#cb74-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">60대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">60-69세</span><span class="st">`</span>), </span>
<span id="cb74-12"><a href="시계열-데이터-정보-다루기.html#cb74-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">70대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">70-79세</span><span class="st">`</span>), </span>
<span id="cb74-13"><a href="시계열-데이터-정보-다루기.html#cb74-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">80대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">80세 이상</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb74-14"><a href="시계열-데이터-정보-다루기.html#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A time tibble: 10 x 10
## # Index: date
##    date       `1대` `10대` `20대` `30대` `40대` `50대` `60대` `70대` `80대`
##    &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 2020-04-11     4     10     24     13     12     11     15      2      5
##  2 2020-04-18     8     18     62     21     13     18     16     11      6
##  3 2020-04-25     1     10     19      7      8      9      4      3      4
##  4 2020-05-02     1      4     23     17     10      3      2      1      1
##  5 2020-05-09     1      4     19     17      8      2      6      1      2
##  6 2020-05-16     6     25     95     32     16      8      9      4      2
##  7 2020-05-23     1     12     29     12     17      6      5      3      0
##  8 2020-05-30     8     21     54     54     43     50     32      7      7
##  9 2020-06-06     6      5     26     24     26     39     44     27      8
## 10 2020-06-13     4     17     43     38     27     69     74     37     23</code></pre>
<ul>
<li>timetk 패키지</li>
</ul>
<p>timetk 패키지에서는 그룹핑을 위해 summarise_by_time() 함수를 제공한다. 매개변수로 .date_var(시간컬럼), .by(그룹핑 단위) 등을 설정하고 산출하기 원하는 컬럼명과 그룹함수를 기재하여 원하는 값을 얻을 수 있다.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="시계열-데이터-정보-다루기.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timetk)</span>
<span id="cb76-2"><a href="시계열-데이터-정보-다루기.html#cb76-2" aria-hidden="true" tabindex="-1"></a>covid19 <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="시계열-데이터-정보-다루기.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_by_time</span>(<span class="at">.date_var =</span> date, <span class="at">.by =</span> <span class="st">&#39;week&#39;</span>, </span>
<span id="cb76-4"><a href="시계열-데이터-정보-다루기.html#cb76-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">`</span><span class="at">1대</span><span class="st">`</span><span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span>), </span>
<span id="cb76-5"><a href="시계열-데이터-정보-다루기.html#cb76-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">10대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">10-19세</span><span class="st">`</span>), </span>
<span id="cb76-6"><a href="시계열-데이터-정보-다루기.html#cb76-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">20대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">20-29세</span><span class="st">`</span>), </span>
<span id="cb76-7"><a href="시계열-데이터-정보-다루기.html#cb76-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">30대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">30-39세</span><span class="st">`</span>), </span>
<span id="cb76-8"><a href="시계열-데이터-정보-다루기.html#cb76-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">40대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">40-49세</span><span class="st">`</span>), </span>
<span id="cb76-9"><a href="시계열-데이터-정보-다루기.html#cb76-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">50대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">50-59세</span><span class="st">`</span>), </span>
<span id="cb76-10"><a href="시계열-데이터-정보-다루기.html#cb76-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">60대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">60-69세</span><span class="st">`</span>), </span>
<span id="cb76-11"><a href="시계열-데이터-정보-다루기.html#cb76-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">70대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">70-79세</span><span class="st">`</span>), </span>
<span id="cb76-12"><a href="시계열-데이터-정보-다루기.html#cb76-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">80대</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">80세 이상</span><span class="st">`</span>))</span></code></pre></div>
<pre><code>## # A tibble: 45 x 10
##    date       `1대` `10대` `20대` `30대` `40대` `50대` `60대` `70대` `80대`
##    &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 2020-04-05     4     10     24     13     12     11     15      2      5
##  2 2020-04-12     8     18     62     21     13     18     16     11      6
##  3 2020-04-19     1     10     19      7      8      9      4      3      4
##  4 2020-04-26     1      4     23     17     10      3      2      1      1
##  5 2020-05-03     1      4     19     17      8      2      6      1      2
##  6 2020-05-10     6     25     95     32     16      8      9      4      2
##  7 2020-05-17     1     12     29     12     17      6      5      3      0
##  8 2020-05-24     8     21     54     54     43     50     32      7      7
##  9 2020-05-31     6      5     26     24     26     39     44     27      8
## 10 2020-06-07     4     17     43     38     27     69     74     37     23
## # ... with 35 more rows</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="시계열-데이터-정보-다루기.html#cb78-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="시계열-데이터-정보-다루기.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_by_time</span>(<span class="at">.date_var =</span> time, <span class="at">.by =</span> <span class="st">&#39;month&#39;</span>, </span>
<span id="cb78-3"><a href="시계열-데이터-정보-다루기.html#cb78-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">total.year =</span> <span class="fu">sum</span>(total), </span>
<span id="cb78-4"><a href="시계열-데이터-정보-다루기.html#cb78-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">employees.edu =</span> <span class="fu">sum</span>(employees.edu)) <span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="시계열-데이터-정보-다루기.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    time       total.year employees.edu
##    &lt;date&gt;          &lt;int&gt;         &lt;int&gt;
##  1 2013-01-01      24287          1710
##  2 2013-02-01      24215          1681
##  3 2013-03-01      24736          1716
##  4 2013-04-01      25322          1745
##  5 2013-05-01      25610          1774
##  6 2013-06-01      25686          1786
##  7 2013-07-01      25681          1813
##  8 2013-08-01      25513          1811
##  9 2013-09-01      25701          1794
## 10 2013-10-01      25798          1790</code></pre>
<ul>
<li>xts 패키지</li>
</ul>
<p>data.frame 클래스의 시계열 객체는 위와 같이 dplyr 패키지의 기능을 이용해 그룹핑하고 그룹함수를 적용용하지만 xts 클래스에서는 시간 유닛별로 그룹핑하여 그룹함수를 적용할 수 있는 함수를 지원한다. 따라서 연 평균, 월 합계와 같은 작업에 편리하게 사용할 수 있다.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="시계열-데이터-정보-다루기.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply.monthly</span>(employees.xts, sum) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##             [,1]
## 2013-01-01 25997
## 2013-02-01 25896
## 2013-03-01 26452
## 2013-04-01 27067
## 2013-05-01 27384
## 2013-06-01 27472
## 2013-07-01 27494
## 2013-08-01 27324
## 2013-09-01 27495
## 2013-10-01 27588</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="시계열-데이터-정보-다루기.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply.weekly</span>(employees.xts, sum) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##             [,1]
## 2013-01-01 25997
## 2013-02-01 25896
## 2013-03-01 26452
## 2013-04-01 27067
## 2013-05-01 27384
## 2013-06-01 27472
## 2013-07-01 27494
## 2013-08-01 27324
## 2013-09-01 27495
## 2013-10-01 27588</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="시계열-데이터-정보-다루기.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply.quarterly</span>(employees.xts, sum) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##             [,1]
## 2013-03-01 78345
## 2013-06-01 81923
## 2013-09-01 82313
## 2013-12-01 82203
## 2014-03-01 80977
## 2014-06-01 83779
## 2014-09-01 84226
## 2014-12-01 83741
## 2015-03-01 82095
## 2015-06-01 84488</code></pre>
</div>
<div id="ohlc-주식-시가-고가-저가-종가는-어떻게-구해" class="section level3" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> OHLC : 주식 시가, 고가, 저가, 종가는 어떻게 구해?</h3>
<p>시계열 데이터를 다룰때 앞서 설명한 grouping을 많이 사용한다. 대부분의 데이터에서는 그룹함수로 제공되는 sum(), mean(), median() 등의 함수를 사용하는 경우가 많지만 시계열 데이터, 특히 금융권 데이터에서는 OHLC 정보를 확인하는 경우도 많다 OHLC는 주어진 기간동안의 첫번째 값(Open), 최대값(High), 최소값(Low), 마지막값(Close) 값을 말한다.</p>
<ul>
<li>lubridate, tibbletime, dplyr 패키지</li>
</ul>
<p>앞서 소개한 collapse_by() 함수를 사용하면 OHLC 정보를 간단히 산출할 수 있다. collapse_by()를 이용해 그룹핑할 시간 주기를 설정하고 group_by()함수를 사용하여 data.frame을 그룹핑한 후 lubridata 패키지의first(), max(), min(), last() 함수를 사용하면 산출이 가능하다.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="시계열-데이터-정보-다루기.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tbl_time</span>(covid19, <span class="at">index =</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="시계열-데이터-정보-다루기.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_by</span>(<span class="st">&#39;weekly&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="시계열-데이터-정보-다루기.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb86-4"><a href="시계열-데이터-정보-다루기.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Open =</span> <span class="fu">first</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span>), </span>
<span id="cb86-5"><a href="시계열-데이터-정보-다루기.html#cb86-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">High =</span> <span class="fu">max</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span>), </span>
<span id="cb86-6"><a href="시계열-데이터-정보-다루기.html#cb86-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Low =</span> <span class="fu">min</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span>), </span>
<span id="cb86-7"><a href="시계열-데이터-정보-다루기.html#cb86-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Close =</span> <span class="fu">last</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-8"><a href="시계열-데이터-정보-다루기.html#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A time tibble: 10 x 5
## # Index: date
##    date        Open  High   Low Close
##    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2020-04-11     2     2     1     1
##  2 2020-04-18     0     3     0     2
##  3 2020-04-25     0     1     0     1
##  4 2020-05-02     2     2    -1     0
##  5 2020-05-09     0     1     0     0
##  6 2020-05-16     0     2     0     2
##  7 2020-05-23     0     1     0     0
##  8 2020-05-30     0     3     0     1
##  9 2020-06-06     0     3     0     3
## 10 2020-06-13     1     1     0     0</code></pre>
<ul>
<li>xts</li>
</ul>
<p>xts 패키지에서는 OHLC 정보를 확인할 수 있는 함수를 직접 제공한다. to.period()함수인데 OHLC를 제공하는데 to.period 함수의 매개변수인 period에 ‘months,’ ‘quarters’ 등 적절한 시간 간격을 설정해주면 해당 기간동안의 OHCL를 자동으로 출력해준다.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="시계열-데이터-정보-다루기.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">to.period</span>(covid19.xts, <span class="at">method =</span> <span class="st">&#39;months&#39;</span>, <span class="at">OLHC =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in to.period(covid19.xts, method = &quot;months&quot;, OLHC = TRUE): missing
## values removed from data</code></pre>
<pre><code>##            covid19.xts.Open covid19.xts.High covid19.xts.Low covid19.xts.Close
## 2020-04-30                2                5               1                 2
## 2020-05-31                0               11               0                 7
## 2020-06-30                0                6               0                 6
## 2020-07-31                0               10              -4                13
## 2020-08-31                1               35               0                15
## 2020-09-30               14               17               0                20
## 2020-10-31                6               11               0                22
## 2020-11-30                5               57               9                32
## 2020-12-31               15               86               0               132
## 2021-01-31               41              138              44                49
## 2021-02-08               20               41              30                31</code></pre>
</div>
<div id="시계열-데이터-rolling" class="section level3" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> 시계열 데이터 Rolling</h3>
<p>주식투자를 하는 분들은 주식거래 프로그램에서 많은 시계열 그래프들을 보게된다. 이들 그래프 중에 어떤 그래프에는 MA(5), MA(10)과 같은 표기가 된 line plot을 볼 수 있는데 이를 이동평균이라고 한다. 최근 5일 평균, 최근 10일 평균과 같이 평균의 기준 범위가 날짜별로 달라지면서 평균을 구하게 되는데 이와 같이 기준일에서 특정 기간의 일, 월의 집합 함수를 적용하는 과정을 rolling이라 하고 rolling의 기간을 rolling window라고 한다. rolling도 앞선 group과 같이 lubridate 패키지에서 제공하는 함수를 dplyr 함수와 파이프라인을 사용하는 방법, timetk 패키지를 사용하는 방법, xts 패키지를 사용하는 방법을 설명하고자 한다.</p>
<ul>
<li>lubridate, dplyr 패키지</li>
</ul>
<p>lubridate 패키지를 사용하여 data.frame 클래스 객체에 대한 rolling은 좀 복잡하다. 하지만 zoo 패키지에서 제공하는 roll* 함수를 사용하면 비교적 쉽게 rolling을 수행할 수있어 이 방법을 소개하고자 한다. 사실 이 방법에서는 lubridate 패키지 함수는 사용되지 않는데 mutate 함수를 이용하여 새로운 컬럼을 생성하는데 각 컬럼을 생성하는 함수로 zoo 패키지의 roll* 함수를 사용한다. roll* 함수는 rollapply()와 rollmean()의 두가지를 제공하는데 rollapply는 apply함수를 rolling용으로 수정한 버젼이고 rollapply 함수에 mean을 적용하는 경우가 많기 때문에 추가적으로 이동평균을 구하는 함수를 제공한다.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="시계열-데이터-정보-다루기.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb91-2"><a href="시계열-데이터-정보-다루기.html#cb91-2" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="시계열-데이터-정보-다루기.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ma3 =</span> <span class="fu">rollmean</span>(total, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb91-4"><a href="시계열-데이터-정보-다루기.html#cb91-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sum3 =</span> <span class="fu">rollapply</span>(total, <span class="dv">3</span>, sum, <span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb91-5"><a href="시계열-데이터-정보-다루기.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total, ma3, sum3) <span class="sc">%&gt;%</span></span>
<span id="cb91-6"><a href="시계열-데이터-정보-다루기.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    total      ma3  sum3
## 1  24287       NA    NA
## 2  24215 24412.67 73238
## 3  24736 24757.67 74273
## 4  25322 25222.67 75668
## 5  25610 25539.33 76618
## 6  25686 25659.00 76977
## 7  25681 25626.67 76880
## 8  25513 25631.67 76895
## 9  25701 25670.67 77012
## 10 25798 25764.67 77294</code></pre>
<ul>
<li>timetk 패키지</li>
</ul>
<p>timetk 패키지에서는 rolling 기능을 위해 slidify() 함수를 제공한다. slidify() 함수가 타 함수와 다른점은 그 반환값이 함수의 실행 결과값이 아니고 함수자체를 반환한다는 것이다. 즉 rolling window 기간에 특정 함수를 적용하는 함수를 제공하기 때문에 이후 함수의 형태로 사용해야 한다. 아래의 예에 m3와 sum3는 data.frame이나 숫자값이 아니고 함수 객체이다. 이 함수 객체는 mutate 함수안에서 함수처럼 작용하는데 그 매개변수로 rolling을 해야할 컬럼을 전달하면 그 결과 벡터가 전달되는 형태로 실행된다.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="시계열-데이터-정보-다루기.html#cb93-1" aria-hidden="true" tabindex="-1"></a>ma3 <span class="ot">&lt;-</span> <span class="fu">slidify</span>(mean, <span class="at">.period =</span> <span class="dv">3</span>, <span class="at">.align =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb93-2"><a href="시계열-데이터-정보-다루기.html#cb93-2" aria-hidden="true" tabindex="-1"></a>sum3 <span class="ot">&lt;-</span> <span class="fu">slidify</span>(sum, <span class="at">.period =</span> <span class="dv">3</span>, <span class="at">.align =</span> <span class="st">&quot;center&quot;</span>)</span>
<span id="cb93-3"><a href="시계열-데이터-정보-다루기.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ma3)</span></code></pre></div>
<pre><code>## [1] &quot;function&quot;</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="시계열-데이터-정보-다루기.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(sum3)</span></code></pre></div>
<pre><code>## [1] &quot;function&quot;</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="시계열-데이터-정보-다루기.html#cb97-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="시계열-데이터-정보-다루기.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ma3 =</span> <span class="fu">ma3</span>(total), <span class="at">sum3 =</span> <span class="fu">sum3</span>(total)) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="시계열-데이터-정보-다루기.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total, ma3, sum3) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="시계열-데이터-정보-다루기.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    total      ma3  sum3
## 1  24287       NA    NA
## 2  24215       NA 73238
## 3  24736 24412.67 74273
## 4  25322 24757.67 75668
## 5  25610 25222.67 76618
## 6  25686 25539.33 76977
## 7  25681 25659.00 76880
## 8  25513 25626.67 76895
## 9  25701 25631.67 77012
## 10 25798 25670.67 77294</code></pre>
<ul>
<li>xts 패키지</li>
</ul>
<p>xts 패키지에서는 rolling을 위한 간단한 함수를 제공한다. rollapply함수로 xts 객체와 rolling window 기간, 적용할 함수를 전달하면 rolling을 간단히 구할수 있다.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="시계열-데이터-정보-다루기.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rollapply</span>(employees.xts, <span class="at">width =</span> <span class="dv">3</span>, <span class="at">FUN =</span> sum) <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="시계열-데이터-정보-다루기.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##            total employees.edu
## 2013-01-01    NA            NA
## 2013-02-01    NA            NA
## 2013-03-01 73238          5107
## 2013-04-01 74273          5142
## 2013-05-01 75668          5235
## 2013-06-01 76618          5305
## 2013-07-01 76977          5373
## 2013-08-01 76880          5410
## 2013-09-01 76895          5418
## 2013-10-01 77012          5395</code></pre>
</div>
<div id="시간-조건-filtering-몇일부터-몇일까지-데이터는" class="section level3" number="4.1.7">
<h3><span class="header-section-number">4.1.7</span> 시간 조건 Filtering : 몇일부터 몇일까지 데이터는?</h3>
<p>시계열 데이터가 아닌 데이터들은 데이터 값에 대한 조건의 결과에 따라 filtering한다. 물론 시계열 데이터도 데이터 값의 조건에 따라 filtering이 가능하지만 시간 인덱스에 조건을 적용하여 filtering도 가능하다.</p>
<ul>
<li>lubridate, dplyr 패키지</li>
</ul>
<p>data.frame에 저장된 시계열 객체의 시간 인덱스 컬럼은 조건 연산자가 산술 연산과 동일하게 적용된다. 따라서 &lt;, &gt;, &lt;=, &gt;= 등의 연산자를 사용하여 인덱스를 filtering하여 전체 데이터를 filtering 할 수 있다.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="시계열-데이터-정보-다루기.html#cb101-1" aria-hidden="true" tabindex="-1"></a>covid19 <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="시계열-데이터-정보-다루기.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&#39;2020-10-01&#39;</span>) <span class="sc">&amp;</span> date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">&#39;2020-10-10&#39;</span>))</span></code></pre></div>
<pre><code>##         date status 0-9세 10-19세 20-29세 30-39세 40-49세 50-59세 60-69세
## 1 2020-10-01   신규     6       4       7       9      14      13      13
## 2 2020-10-02   신규     3       6       6      10       6      11      13
## 3 2020-10-03   신규     1       1       6      13      11      11      16
## 4 2020-10-04   신규     0       4       4       9      13       8      12
## 5 2020-10-05   신규     0       3      17       9       8      12      14
## 6 2020-10-06   신규     5       8      26       8       2      11       9
## 7 2020-10-07   신규     1       2       8      13      10      28      31
## 8 2020-10-08   신규     6       5       6       7       9      12      11
## 9 2020-10-10   신규     0       0       0       0       0       0       0
##   70-79세 80세 이상
## 1       7         4
## 2       4         4
## 3      13         3
## 4       8         6
## 5       6         4
## 6       4         2
## 7      16         5
## 8      10         3
## 9       0         0</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="시계열-데이터-정보-다루기.html#cb103-1" aria-hidden="true" tabindex="-1"></a>covid19 <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="시계열-데이터-정보-다루기.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(date, <span class="fu">as.Date</span>(<span class="st">&#39;2021-01-01&#39;</span>), <span class="fu">as.Date</span>(<span class="st">&#39;2021-01-15&#39;</span>)))</span></code></pre></div>
<pre><code>##          date status 0-9세 10-19세 20-29세 30-39세 40-49세 50-59세 60-69세
## 1  2021-01-01   신규    41      74     131     145     154     204     159
## 2  2021-01-02   신규    39      66     111     109     106     160     125
## 3  2021-01-03   신규    32      46      80      75      88     124     117
## 4  2021-01-04   신규    40      71     120     127     172     187     153
## 5  2021-01-05   신규    45      44     107     105     112     124     108
## 6  2021-01-06   신규    45      60     106     106     110     140     148
## 7  2021-01-07   신규    41      54     123     120     155     176     113
## 8  2021-01-08   신규    34      43      91      86      83     124     125
## 9  2021-01-09   신규    32      50     100      91      89     124      80
## 10 2021-01-10   신규    36      56      87      79      94     143      87
## 11 2021-01-11   신규    19      36      47      54      61      79      79
## 12 2021-01-12   신규    32      34      71      59      91     102      74
## 13 2021-01-13   신규    24      28      66      81      83     129      87
## 14 2021-01-14   신규    25      45      60      67      82      98      71
## 15 2021-01-15   신규    42      37      62      70      81      97      91
##    70-79세 80세 이상
## 1       80        41
## 2       59        49
## 3       51        38
## 4       69        81
## 5       44        26
## 6       73        51
## 7       59        27
## 8       49        37
## 9       50        25
## 10      49        34
## 11      44        31
## 12      39        35
## 13      47        16
## 14      39        29
## 15      22        11</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="시계열-데이터-정보-다루기.html#cb105-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="시계열-데이터-정보-다루기.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(time) <span class="sc">==</span> <span class="dv">2019</span> <span class="sc">&amp;</span> <span class="fu">month</span>(time) <span class="sc">==</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##         time total employees.edu
## 1 2019-05-01 27322          1884</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="시계열-데이터-정보-다루기.html#cb107-1" aria-hidden="true" tabindex="-1"></a>covid19 <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="시계열-데이터-정보-다루기.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(<span class="fu">day</span>(date), <span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">%&gt;%</span>  <span class="co"># 매월 3일부터 7일까지 filtering</span></span>
<span id="cb107-3"><a href="시계열-데이터-정보-다루기.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>##          date status 0-9세 10-19세 20-29세 30-39세 40-49세 50-59세 60-69세
## 1  2020-05-03   신규     0       1       2       3       2       0       2
## 2  2020-05-04   신규     0       0       2       1       3       0       2
## 3  2020-05-05   신규     0       0       0       1       1       1       0
## 4  2020-05-06   신규     0       0       0       1       0       0       1
## 5  2020-05-07   신규     0       1       2       1       0       0       0
## 6  2020-06-03   신규     1       2       5       6       5       9      15
## 7  2020-06-04   신규     1       0       5       3       3       9       9
## 8  2020-06-05   신규     1       2       5       2       3       7      10
## 9  2020-06-06   신규     3       1       2       6      11       8       9
## 10 2020-06-07   신규     1       6       3       6       8      11      12
## 11 2020-07-03   신규     2      10      10      10       6       7      11
## 12 2020-07-04   신규     3       2      12      16       8       8       9
## 13 2020-07-05   신규     3       3       8       9      11       7      14
## 14 2020-07-06   신규     4       1       7      10       6       9       4
## 15 2020-07-07   신규     1       2      12       6       7       7       7
##    70-79세 80세 이상
## 1        1         2
## 2        0         0
## 3        0         0
## 4        0         0
## 5        0         0
## 6        6         0
## 7        6         3
## 8        7         2
## 9        8         3
## 10       8         2
## 11       4         3
## 12       2         3
## 13       6         0
## 14       2         3
## 15       2         0</code></pre>
<ul>
<li>timetk 패키지</li>
</ul>
<p>timetk 패키지에서는 filter_by_time() 함수를 제공한다. 이 함수는 dplyr 패키지의 파이프라인(%&gt;%)을 이용해서 시계열 데이터를 filtering 할 수 있다. 매개변수 .start로 시작일과 .end 종료일을 전달하면 해당 기간동안의 데이터를 반환한다. 또 timetk에서는 주어진 기간동안의 데이터에 한하여 조건에 적합한 데이터를 반환하는 filter_period() 함수를 제공한다. filter_period() 함수는 위에서 설명한 xts의 누적값을 구하는 방법과 유사하게 작동하는데 우선 데이터를 filter_period() 에서 설정한 기간으로 나누고 나뉘어진 데이터 내에서 주어진 조건에 적합한 결과들을 산출해서 반환한다. 예를 들어 매월 최대 매출일을 기록한 날, 매년 월평균 매출액보다 큰 매출을 기록한 월 등을 산출할 때 유용하다.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="시계열-데이터-정보-다루기.html#cb109-1" aria-hidden="true" tabindex="-1"></a>covid19 <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="시계열-데이터-정보-다루기.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_by_time</span>(<span class="at">.date_var =</span> date, <span class="at">.start =</span> <span class="st">&#39;2020-10-01&#39;</span>, <span class="at">.end =</span> <span class="st">&#39;2020-10-05&#39;</span>)</span></code></pre></div>
<pre><code>##         date status 0-9세 10-19세 20-29세 30-39세 40-49세 50-59세 60-69세
## 1 2020-10-01   신규     6       4       7       9      14      13      13
## 2 2020-10-02   신규     3       6       6      10       6      11      13
## 3 2020-10-03   신규     1       1       6      13      11      11      16
## 4 2020-10-04   신규     0       4       4       9      13       8      12
## 5 2020-10-05   신규     0       3      17       9       8      12      14
##   70-79세 80세 이상
## 1       7         4
## 2       4         4
## 3      13         3
## 4       8         6
## 5       6         4</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="시계열-데이터-정보-다루기.html#cb111-1" aria-hidden="true" tabindex="-1"></a>covid19 <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="시계열-데이터-정보-다루기.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span> <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="시계열-데이터-정보-다루기.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_period</span>(<span class="at">.date_var =</span> date, <span class="at">.period =</span> <span class="st">&#39;1 month&#39;</span>, <span class="st">`</span><span class="at">0-9세</span><span class="st">`</span> <span class="sc">==</span> <span class="fu">max</span>(<span class="st">`</span><span class="at">0-9세</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="시계열-데이터-정보-다루기.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 11
##    date       status `0-9세` `10-19세` `20-29세` `30-39세` `40-49세` `50-59세`
##    &lt;date&gt;     &lt;fct&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 2020-04-16 신규         3         3         5         1         2         3
##  2 2020-05-27 신규         3         2         8         6         3         6
##  3 2020-06-06 신규         3         1         2         6        11         8
##  4 2020-06-23 신규         3         0         4         9         9         9
##  5 2020-06-29 신규         3         1         9         5         6         5
##  6 2020-06-30 신규         3         4        10         6         8         6
##  7 2020-07-17 신규        10         4        26        37        32        23
##  8 2020-08-23 신규        16        35        34        40        62        82
##  9 2020-08-28 신규        16        17        32        48        53        73
## 10 2020-08-29 신규        16        18        31        36        47        54
## # ... with 3 more variables: `60-69세` &lt;dbl&gt;, `70-79세` &lt;dbl&gt;, `80세
## #   이상` &lt;dbl&gt;</code></pre>
<ul>
<li>xts 패키지</li>
</ul>
<p>xts 객체의 시간 인덱스 filtering은 앞선 lubridate, dplyr, timetk와는 조금 달리 filtering이 가능하다. xts 객체는 함수로 filtering하지 않고 [ ]내에 조건을 전달할 수 있고 연산자인 ’/’로 기간 구간을 설정할 수 있다.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="시계열-데이터-정보-다루기.html#cb113-1" aria-hidden="true" tabindex="-1"></a>covid19.xts[<span class="st">&#39;2020-10-02&#39;</span>]   <span class="do">### 2020-10-02에 해당하는 데이터 filtering</span></span></code></pre></div>
<pre><code>##            0-9세 10-19세 20-29세 30-39세 40-49세 50-59세 60-69세 70-79세
## 2020-10-02     3       6       6      10       6      11      13       4</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="시계열-데이터-정보-다루기.html#cb115-1" aria-hidden="true" tabindex="-1"></a>covid19.xts[<span class="st">&#39;2020-10-01/2020-10-10&#39;</span>]  <span class="do">### 2020-10-01에서부터 2020-10-10 까지 데이터 filtering</span></span></code></pre></div>
<pre><code>##            0-9세 10-19세 20-29세 30-39세 40-49세 50-59세 60-69세 70-79세
## 2020-10-01     6       4       7       9      14      13      13       7
## 2020-10-02     3       6       6      10       6      11      13       4
## 2020-10-03     1       1       6      13      11      11      16      13
## 2020-10-04     0       4       4       9      13       8      12       8
## 2020-10-05     0       3      17       9       8      12      14       6
## 2020-10-06     5       8      26       8       2      11       9       4
## 2020-10-07     1       2       8      13      10      28      31      16
## 2020-10-08     6       5       6       7       9      12      11      10
## 2020-10-10     0       0       0       0       0       0       0       0</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="시계열-데이터-정보-다루기.html#cb117-1" aria-hidden="true" tabindex="-1"></a>covid19.xts[<span class="st">&#39;2021-02-05/&#39;</span>] <span class="do">### 2021-02-05일 부터 끝까지 데이터 filtering</span></span></code></pre></div>
<pre><code>##            0-9세 10-19세 20-29세 30-39세 40-49세 50-59세 60-69세 70-79세
## 2021-02-05    30      28      30      60      42      65      75      25
## 2021-02-06    25      31      53      41      60      77      63      30
## 2021-02-07    21      27      51      47      44      79      66      26
## 2021-02-08    19       9      35      31      53      52      59      22
## 2021-02-09    15      NA      33      41      52      59      38      28</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="시계열-데이터-정보-다루기.html#cb119-1" aria-hidden="true" tabindex="-1"></a>covid19.xts[<span class="st">&#39;/2020-04-11&#39;</span>]   <span class="do">### 처음부터 2020-04-11까지의 filtering</span></span></code></pre></div>
<pre><code>##            0-9세 10-19세 20-29세 30-39세 40-49세 50-59세 60-69세 70-79세
## 2020-04-09     2       4      12       7       7       2       2       0
## 2020-04-10     1       1       7       4       2       3       6       2
## 2020-04-11     1       5       5       2       3       6       7       0</code></pre>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p><a href="https://cran.r-project.org/web/packages/lubridate/vignettes/lubridate.html" class="uri">https://cran.r-project.org/web/packages/lubridate/vignettes/lubridate.html</a><a href="시계열-데이터-정보-다루기.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><a href="https://rdrr.io/cran/lubridate/man/round_date.html" class="uri">https://rdrr.io/cran/lubridate/man/round_date.html</a><a href="시계열-데이터-정보-다루기.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p><a href="https://cran.r-project.org/web/packages/tibbletime/vignettes/TT-04-use-with-dplyr.html" class="uri">https://cran.r-project.org/web/packages/tibbletime/vignettes/TT-04-use-with-dplyr.html</a><a href="시계열-데이터-정보-다루기.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="시계열-데이터-handling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="시계열-데이터-실응용-사례.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["t.pdf", "t.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
